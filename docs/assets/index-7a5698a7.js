var Ct=Object.defineProperty;var Rt=(i,e,t)=>e in i?Ct(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var w=(i,e,t)=>(Rt(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const we=class we{constructor(...e){w(this,"cancelables");w(this,"_isCancelled");this.cancelables=e??[],this._isCancelled=!1}get isCancelled(){return this._isCancelled}static fromMultiple(e){const t=new we;for(const n of e)n.chain(t);return t}hasCancellables(){return this.cancelables.length>0}addCancellable(e){return this.throwIfCancelled("attempting to add cancellable to token that is already cancelled"),this.cancelables.push(e),this.cancelables.length===200&&console.log("potential memory leak: cancellation token has over 200 clean up calls"),this}removeCancellable(e){this.throwIfCancelled("attempting to remove cancellable from token that is already cancelled");const t=this.cancelables.indexOf(e);return t!==-1&&this.cancelables.splice(t,1),this}setTimeout(e,t=0){const n=setTimeout(()=>{this.removeCancellable(s),e()},t),s=()=>clearTimeout(n);this.addCancellable(s)}setInterval(e,t){const n=setInterval(e,t);this.addCancellable(()=>clearInterval(n))}requestAnimationFrame(e){const t=requestAnimationFrame(()=>{this.removeCancellable(n),e()}),n=()=>cancelAnimationFrame(t);this.addCancellable(n)}animationLoop(e){ut(e,this)}throwIfCancelled(e){if(this.isCancelled)throw new Error(e||"cancellation token is cancelled")}chain(e,t=!1){const n=()=>e.cancel();return t?e.chain(this,!1):e.addCancellable(()=>{this.isCancelled||this.removeCancellable(n)}),this.addCancellable(n),this}registerDomEvent(e,t,n){return e.addEventListener(t,n),this.addCancellable(()=>e.removeEventListener(t,n)),this}registerEmitterEvent(e,t,n){return e.on(t,n),this.addCancellable(()=>e.off(t,n)),this}cancel(){this.isCancelled||(this._isCancelled=!0,this.cancelables.forEach(e=>e()),this.cancelables=void 0)}};w(we,"forever",new we);let T=we;const ge=[];let Ce=!1;function ut(i,e){ge.push(i),e.addCancellable(()=>{ge.splice(ge.indexOf(i),1)}),Ce||(Ce=!0,requestAnimationFrame(dt))}function dt(i){for(const e of ge)try{e(i)}catch(t){console.error(t)}ge.length===0&&(Ce=!1),Ce&&requestAnimationFrame(dt)}T.forever.addCancellable=()=>{};T.forever.cancel=()=>{throw new Error("Cannot cancel forever token")};var O;(function(i){i[i.HEARTBEAT=0]="HEARTBEAT",i[i.LISTEN_DATASOURCE=1]="LISTEN_DATASOURCE",i[i.LISTEN_DATASOURCE_ERR=2]="LISTEN_DATASOURCE_ERR",i[i.UPDATE_DATASOURCE=3]="UPDATE_DATASOURCE",i[i.UPDATE_DATASOURCE_ERR=4]="UPDATE_DATASOURCE_ERR",i[i.CANCEL_DATASOURCE=5]="CANCEL_DATASOURCE",i[i.PERFORM_RPC=6]="PERFORM_RPC",i[i.PERFORM_RPC_ERR=7]="PERFORM_RPC_ERR",i[i.PERFORM_RPC_RESULT=8]="PERFORM_RPC_RESULT",i[i.PERFORM_RPC_RESULT_ERR=9]="PERFORM_RPC_RESULT_ERR",i[i.LISTEN_DUPLEX_DATASOURCE_ERR=10]="LISTEN_DUPLEX_DATASOURCE_ERR",i[i.LISTEN_DUPLEX_DATASOURCE=11]="LISTEN_DUPLEX_DATASOURCE",i[i.UPDATE_DUPLEX_DATASOURCE=12]="UPDATE_DUPLEX_DATASOURCE",i[i.UPDATE_DUPLEX_DATASOURCE_ERR=13]="UPDATE_DUPLEX_DATASOURCE_ERR",i[i.CANCEL_DUPLEX_DATASOURCE=14]="CANCEL_DUPLEX_DATASOURCE",i[i.LISTEN_ARRAY_DATASOURCE=15]="LISTEN_ARRAY_DATASOURCE",i[i.LISTEN_ARRAY_DATASOURCE_ERR=16]="LISTEN_ARRAY_DATASOURCE_ERR",i[i.UPDATE_ARRAY_DATASOURCE=17]="UPDATE_ARRAY_DATASOURCE",i[i.UPDATE_ARRAY_DATASOURCE_ERR=18]="UPDATE_ARRAY_DATASOURCE_ERR",i[i.CANCEL_ARRAY_DATASOURCE=19]="CANCEL_ARRAY_DATASOURCE",i[i.LISTEN_MAP_DATASOURCE=20]="LISTEN_MAP_DATASOURCE",i[i.LISTEN_MAP_DATASOURCE_ERR=21]="LISTEN_MAP_DATASOURCE_ERR",i[i.UPDATE_MAP_DATASOURCE=22]="UPDATE_MAP_DATASOURCE",i[i.UPDATE_MAP_DATASOURCE_ERR=23]="UPDATE_MAP_DATASOURCE_ERR",i[i.CANCEL_MAP_DATASOURCE=24]="CANCEL_MAP_DATASOURCE",i[i.LISTEN_OBJECT_DATASOURCE=25]="LISTEN_OBJECT_DATASOURCE",i[i.LISTEN_OBJECT_DATASOURCE_ERR=26]="LISTEN_OBJECT_DATASOURCE_ERR",i[i.UPDATE_OBJECT_DATASOURCE=27]="UPDATE_OBJECT_DATASOURCE",i[i.UPDATE_OBJECT_DATASOURCE_ERR=28]="UPDATE_OBJECT_DATASOURCE_ERR",i[i.CANCEL_OBJECT_DATASOURCE=29]="CANCEL_OBJECT_DATASOURCE",i[i.LISTEN_SET_DATASOURCE=30]="LISTEN_SET_DATASOURCE",i[i.LISTEN_SET_DATASOURCE_ERR=31]="LISTEN_SET_DATASOURCE_ERR",i[i.UPDATE_SET_DATASOURCE=32]="UPDATE_SET_DATASOURCE",i[i.UPDATE_SET_DATASOURCE_ERR=33]="UPDATE_SET_DATASOURCE_ERR",i[i.CANCEL_SET_DATASOURCE=34]="CANCEL_SET_DATASOURCE"})(O||(O={}));const pe=new Map;function nr(i,e){return _t(i,e)}function _t(i,e){const t=G(i.protocol,i.host);return async n=>(await ie(t,i.protocol,i.host),new Promise((s,a)=>{const o=K.get(t);if(!o)throw new Error("Client not connected");return o.performRPC(n,i.id,i.authenticationToken,e).then(s,a)}))}async function Ot(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncSetDataSource(i,e.id,e.authenticationToken,t)}async function It(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncObjectDataSource(i,e.id,e.authenticationToken,t)}async function Lt(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncMapDataSource(i,e.id,e.authenticationToken,t)}async function Nt(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncDataSource(i,e.id,e.authenticationToken,t)}function G(i,e){return`${ht(i)}://${ft(e)}`}async function Mt(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncArrayDataSource(i,e.id,e.authenticationToken,t)}async function Ut(i,e,t){const n=G(e.protocol,e.host);await ie(n,e.protocol,e.host),K.get(n).syncDuplexDataSource(i,e.id,e.authenticationToken,t)}const K=new Map,Se=new Map;class Fe{constructor(e){w(this,"masterToken");w(this,"connection");w(this,"synchedDataSources");w(this,"synchedDuplexDataSources");w(this,"synchedArrayDataSources");w(this,"synchedMapDataSources");w(this,"synchedObjectDataSources");w(this,"synchedSetDataSources");this.masterToken=new T,this.connection=e,this.synchedDataSources=new Map,this.synchedDuplexDataSources=new Map,this.synchedArrayDataSources=new Map,this.synchedMapDataSources=new Map,this.synchedObjectDataSources=new Map,this.synchedSetDataSources=new Map}syncDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedDataSources,O.LISTEN_DATASOURCE,O.CANCEL_DATASOURCE)}syncObjectDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedObjectDataSources,O.LISTEN_OBJECT_DATASOURCE,O.CANCEL_OBJECT_DATASOURCE)}performRPC(e,t,n,s){return new Promise((a,o)=>{const l=Math.random().toString();pe.set(l,{resolve:a,reject:o}),this.connection.send(JSON.stringify({type:O.PERFORM_RPC,token:n,id:t,value:e,uuid:l}))})}syncSetDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedSetDataSources,O.LISTEN_SET_DATASOURCE,O.CANCEL_SET_DATASOURCE)}syncMapDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedMapDataSources,O.LISTEN_MAP_DATASOURCE,O.CANCEL_MAP_DATASOURCE)}syncArrayDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedArrayDataSources,O.LISTEN_ARRAY_DATASOURCE,O.CANCEL_ARRAY_DATASOURCE)}syncDuplexDataSource(e,t,n,s){this.syncSource(s,t,n,e,this.synchedDuplexDataSources,O.LISTEN_DUPLEX_DATASOURCE,O.CANCEL_DUPLEX_DATASOURCE),e.listenUpstream(a=>{this.connection.send(JSON.stringify({type:O.UPDATE_DUPLEX_DATASOURCE,token:n,value:a,id:t}))},T.fromMultiple([s,this.masterToken]))}syncSource(e,t,n,s,a,o,l){e.addCancellable(()=>{const c=a.get(t),h=c.get(n);h.listeners.splice(h.listeners.findIndex(d=>d.source===s)),h.listeners.length===0&&(c.delete(n),h.source.cancelAll(),this.connection.send(JSON.stringify({type:l,id:t,token:n})))}),a.has(t)||a.set(t,new Map),a.get(t).has(n)||(this.connection.send(JSON.stringify({type:o,id:t,token:n})),a.get(t).set(n,{source:s,listeners:[]})),a.get(t).get(n).listeners.push({source:s,token:e})}static connect(e,t){let n=new T,s=!1,a=[0,0,0,0,0],o=0,l,c;return new Promise((h,d)=>{t=ht(t),e=ft(e);const f=new WebSocket(`${t}://${e}`),p=new Fe(f);p.masterToken.addCancellable(()=>{K.delete(G(t,e))}),n.setTimeout(()=>{f.close(4001,"no response"),d(),p.masterToken.cancel()},5e3),f.addEventListener("message",m=>{c=Date.now();try{const v=JSON.parse(m.data);switch(v.type){case O.HEARTBEAT:a[o]=Date.now()-l,(o+1)%a.length===0?(console.log(`AurumServer latency: ${(a.reduce((b,A)=>b+A)/a.length).toFixed(1)}ms`),o=0):o++;break;case O.PERFORM_RPC_RESULT_ERR:case O.PERFORM_RPC_ERR:pe.get(v.uuid).reject(new Error(v.error)),pe.delete(v.uuid);break;case O.PERFORM_RPC_RESULT:pe.get(v.uuid).resolve(v.result),pe.delete(v.uuid);break;case O.UPDATE_DATASOURCE:if(p.synchedDataSources.has(v.id)){const b=p.synchedDataSources.get(v.id);for(const A of b.values())A.source.update(v.value)}break;case O.UPDATE_ARRAY_DATASOURCE:if(p.synchedArrayDataSources.has(v.id)){const b=p.synchedArrayDataSources.get(v.id);for(const A of b.values()){const R=v.change;A.source.applyCollectionChange(R)}}break;case O.UPDATE_DUPLEX_DATASOURCE:if(p.synchedDuplexDataSources.has(v.id)){const b=p.synchedDuplexDataSources.get(v.id);for(const A of b.values())A.source.updateDownstream(v.value)}break;case O.UPDATE_MAP_DATASOURCE:if(p.synchedMapDataSources.has(v.id)){const b=p.synchedMapDataSources.get(v.id);for(const A of b.values())A.source.applyMapChange(v.change)}break}}catch(v){console.warn("Recieved malformed message from server"),console.warn(v)}}),f.addEventListener("error",m=>{p.masterToken.cancel(),d(m)}),f.addEventListener("open",()=>{n.cancel(),n=void 0,s=!0,c=Date.now(),p.masterToken.setInterval(()=>{if(Date.now()-c>1e4){f.close(4e3,"timeout");return}l=Date.now(),f.send(JSON.stringify({type:O.HEARTBEAT}))},2500),h(p)}),f.addEventListener("close",()=>{p.masterToken.cancel(),s?ie(G(t,e),t,e).then(m=>{m.migrate(p)}):d()})})}migrate(e){for(const t of e.synchedDataSources.keys())for(const n of e.synchedDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedDataSources.get(t).get(n).listeners)this.syncDataSource(s,t,n,a);for(const t of e.synchedArrayDataSources.keys())for(const n of e.synchedArrayDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedArrayDataSources.get(t).get(n).listeners)this.syncArrayDataSource(s,t,n,a);for(const t of e.synchedDuplexDataSources.keys())for(const n of e.synchedDuplexDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedDuplexDataSources.get(t).get(n).listeners)this.syncDuplexDataSource(s,t,n,a);for(const t of e.synchedMapDataSources.keys())for(const n of e.synchedMapDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedMapDataSources.get(t).get(n).listeners)this.syncMapDataSource(s,t,n,a);for(const t of e.synchedObjectDataSources.keys())for(const n of e.synchedObjectDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedObjectDataSources.get(t).get(n).listeners)this.syncObjectDataSource(s,t,n,a);for(const t of e.synchedSetDataSources.keys())for(const n of e.synchedSetDataSources.get(t).keys())for(const{source:s,token:a}of e.synchedSetDataSources.get(t).get(n).listeners)this.syncSetDataSource(s,t,n,a);this.synchedDataSources=new Map,this.synchedDuplexDataSources=new Map,this.synchedArrayDataSources=new Map,this.synchedMapDataSources=new Map,this.synchedObjectDataSources=new Map,this.synchedSetDataSources=new Map}}function ht(i){if(!i){if(typeof location>"u")throw new Error("Protocol is not optional in non browser environments");location.protocol.startsWith("https")?i="wss":i="ws"}return i}function ft(i){if(!i){if(typeof location>"u")throw new Error("Host is not optional in non browser environments");return location.host}return i}async function ie(i,e,t){if(K.has(i))return K.get(i);let n=1e3;if(Se.has(i))return Se.get(i);{const s=new Promise(a=>{async function o(){const l=Fe.connect(t,e);try{const c=await l;K.set(i,c),Se.delete(i),a(c),n=1e3}catch{setTimeout(()=>{n+=1e3,o()},n)}}o()});return Se.set(i,s),s}}const Q=class Q{constructor(){w(this,"isFiring");w(this,"onAfterFire");w(this,"onEmpty");w(this,"subscribeChannel");w(this,"subscribeOnceChannel");this.subscribeChannel=[],this.subscribeOnceChannel=[],this.onAfterFire=[]}static setSubscriptionLeakWarningThreshold(e){Q.leakWarningThreshold=e}get subscriptions(){return this.subscribeChannel.length+this.subscribeOnceChannel.length}toAsyncIterator(e){const t=new Array;let n;return e==null||e.addCancellable(()=>{n?n({done:!0,value:void 0}):t.push({done:!0,value:void 0})}),this.subscribe(s=>{n?(n({done:!1,value:s}),n=void 0):t.push({done:!1,value:s})},e),{[Symbol.asyncIterator](){return this},async next(){return t.length>0?t.shift():new Promise(s=>{n=s})}}}subscribe(e,t){const{facade:n}=this.createSubscription(e,this.subscribeChannel,t);return Q.leakWarningThreshold&&this.subscribeChannel.length>Q.leakWarningThreshold&&console.warn(`Observable has ${this.subscribeChannel.length} subscriptions. This could potentially indicate a memory leak`),n}subscribeOnce(e,t){const{facade:n}=this.createSubscription(e,this.subscribeOnceChannel,t);return Q.leakWarningThreshold&&this.subscribeOnceChannel.length>Q.leakWarningThreshold&&console.warn(`Observable has ${this.subscribeOnceChannel.length} one time subscriptions. This could potentially indicate a memory leak`),n}hasSubscriptions(){return this.subscriptions>0}cancelAll(){var e;this.isFiring?this.onAfterFire.push(()=>{var t;this.subscribeChannel.length=0,this.subscribeOnceChannel.length=0,(t=this.onEmpty)==null||t.call(this)}):(this.subscribeChannel.length=0,this.subscribeOnceChannel.length=0,(e=this.onEmpty)==null||e.call(this))}afterFire(){this.onAfterFire.length>0&&(this.onAfterFire.forEach(e=>e()),this.onAfterFire.length=0)}fire(e){const t=this.subscribeChannel.length,n=this.subscribeOnceChannel.length;if(t===0&&n===0)return;this.isFiring=!0;let s;for(let a=0;a<t;a++)try{this.subscribeChannel[a].callback(e)}catch(o){s=o,console.error(o)}if(this.subscribeOnceChannel.length>0){for(let a=0;a<n;a++)try{this.subscribeOnceChannel[a].callback(e)}catch(o){s=o,console.error(o)}this.subscribeOnceChannel.length=0}if(this.isFiring=!1,this.afterFire(),s)throw s}createSubscription(e,t,n){const s=this,a={callback:e},o={cancel(){s.cancel(a,t)}};return n!==void 0&&n.addCancellable(()=>s.cancel(a,t)),this.isFiring?this.onAfterFire.push(()=>t.push(a)):t.push(a),{subscription:a,facade:o}}cancel(e,t){var s;let n=t.indexOf(e);n>=0&&(this.isFiring?this.onAfterFire.push(()=>this.cancel(e,t)):(t.splice(n,1),this.hasSubscriptions()||(s=this.onEmpty)==null||s.call(this)))}};w(Q,"leakWarningThreshold");let I=Q,ce=!1;const ee=globalThis;let ue;function sr(){ue=[],ce=!0,setInterval(()=>zt(),6e4),ee.__debugUpdates=new I,ee.__debugNewSource=new I,ee.__debugLinked=new I,ee.__debugUnlinked=new I,ee.__debugGetStreamData=()=>ue.map(Ae)}function Ae(i){let e;try{e=JSON.stringify(i.value)}catch{e="[Unserializable]"}return{name:i.name,value:e,children:i.children,consumers:i.consumers,id:i.id,parents:i.parents,stack:i.stack,timestamp:i.timestamp}}function Pt(i,e){const t={name:i.name,value:i.value,id:Math.random(),children:[],parents:[],stack:e,timestamp:Date.now(),reference:new WeakRef(i),consumers:[]};ue.push(t),ee.__debugNewSource.fire({source:Ae(t)})}function qe(i,e){let t=Re(i),n=Re(e);if(!t)throw new Error("illegal state");if(!n)throw new Error("illegal state");t.children.push(n.id),n.parents.push(t.id),ee.__debugLinked.fire({child:Ae(n),parent:Ae(t)})}function $t(i,e,t){let n=Re(i);if(!n)throw new Error("illegal state");n.value=i.value,ee.__debugUpdates.fire({newValue:e,source:Ae(n),stack:t})}function Ft(i,e,t){let n=Re(i);if(!n)throw new Error("illegal state");n.consumers.push({code:e,stack:t})}function zt(){ue=ue.filter(i=>i.reference.deref()!==void 0)}function Re(i){return ue.find(e=>e.reference.deref()===i)}var k;(function(i){i[i.FILTER=0]="FILTER",i[i.NOOP=1]="NOOP",i[i.MAP=2]="MAP",i[i.DELAY=3]="DELAY",i[i.MAP_DELAY=4]="MAP_DELAY",i[i.DELAY_FILTER=5]="DELAY_FILTER",i[i.MAP_DELAY_FILTER=6]="MAP_DELAY_FILTER"})(k||(k={}));const Le=Symbol("filtered");async function*ir(i,e,t,n,s,a,o,l,c,h,d,f,p){let m;const v=[e,t,n,s,a,o,l,c,h,d,f].filter(A=>A&&(A instanceof T?(m=A,!1):!0));p&&(m=p);const b=async A=>{try{for(const R of v)switch(R.operationType){case k.NOOP:case k.MAP:A=R.operation(A);break;case k.MAP_DELAY_FILTER:const U=await R.operation(A);if(U.cancelled)return;A=await U.item;break;case k.DELAY:case k.MAP_DELAY:A=await R.operation(A);break;case k.DELAY_FILTER:if(!await R.operation(A))return Le;break;case k.FILTER:if(!R.operation(A))return Le;break}return A}catch(R){throw R}};for await(const A of i){if(m!=null&&m.isCancelled)return;const R=await b(A);R!==Le&&(yield R)}}function ze(i,e){let t=i.length;const n=new g;e=e??new T;for(const s of i)s.then(a=>{t--,n.update({status:"fulfilled",value:a}),t===0&&e.cancel()},a=>{t--,n.update({status:"rejected",reason:a}),t===0&&e.cancel()});return n.toAsyncIterator(e)}class F{constructor(){w(this,"input");w(this,"output")}get name(){return`IN:${this.input.name} OUT:${this.output.name}`}get value(){return this.output.value}static fromFunction(e){const t=new F;return t.input=new g,t.output=new g,t.input.listen(n=>{t.output.update(e(n))}),t}static fromFetchRaw(e){const t=new g,n=new g;return t.listen(s=>{n.update(fetch(e,s))}),F.fromPreconnectedSources(t,n)}static fromPreconnectedSources(e,t){const n=new F;return n.input=e??new g,n.output=t??n.input,n}aggregate(e,t,n){n=n??new T;const s=new g(t(this.value,...e.map(a=>a.value)));for(let a=0;a<e.length;a++)e[a].listen(()=>{s.update(t(this.value,...e.map(o=>o.value)))},n);return this.listen(()=>s.update(t(this.value,...e.map(a=>a.value))),n),s}static fromStreamTransformation(e,t,n,s,a,o,l,c,h,d){const f=new F;return f.input=new g,f.output=f.input.transform(e,t,n,s,a,o,l,c,h,d),f}static fromFetchPostJson(e,t){const n=new g,s=new g;return n.listen(async a=>{s.update(await fetch(e,Object.assign({method:"POST",headers:{"Content-Type":"application/json"}},t,{body:JSON.stringify(a)})).then(o=>o.json()))}),F.fromPreconnectedSources(n,s)}static fromFetchGetJson(e,t){const n=new g,s=new g;return n.listen(async()=>{s.update(await fetch(e).then(a=>a.json()))}),F.fromPreconnectedSources(n,s)}update(e){this.input.update(e)}transform(e,t,n,s,a,o,l,c,h,d,f,p){let m;const v=[e,t,n,s,a,o,l,c,h,d,f].filter(A=>A&&(A instanceof T?(m=A,!1):!0));p&&(m=p);const b=new g(void 0,this.output.name+" "+v.map(A=>A.name).join(" "));return this.listen(Ie(v,b),m),F.fromPreconnectedSources(this.input,b)}getInput(){return this.input}getOutput(){return this.output}listen(e,t){return this.output.listen(e,t)}listenAndRepeat(e,t){return this.output.listenAndRepeat(e,t)}listenOnce(e,t){return this.output.listenOnce(e,t)}awaitNextUpdate(e){return this.output.awaitNextUpdate(e)}cancelAll(){this.input.cancelAll(),this.output.cancelAll()}}function re(i){return{name:"map",operationType:k.MAP,operation:e=>i(e)}}function rr(i,e,t){return{name:"fork",operationType:k.NOOP,operation:n=>(i(n)?e.update(n):t.update(n),n)}}function ar(i){return{name:"mapAsync",operationType:k.MAP_DELAY,operation:e=>i(e)}}function pt(){let i;return{name:"diff",operationType:k.MAP,operation:e=>{let t={oldValue:i,newValue:e};return i=e,t}}}function or(){let i;return{name:"diff",operationType:k.MAP,operation:e=>(i&&i.cancel(),i=new T,{token:i,value:e})}}function lr(i){return{name:"filter",operationType:k.FILTER,operation:e=>i(e)}}function cr(i){return{name:"filterAsync",operationType:k.DELAY_FILTER,operation:e=>i(e)}}function ur(){return{name:"even",operationType:k.FILTER,operation:i=>i%2===0}}function dr(){return{name:"odd",operationType:k.FILTER,operation:i=>i%2!==0}}function hr(){let i=Number.MAX_SAFE_INTEGER;return{name:"min",operationType:k.FILTER,operation:e=>e<i?(i=e,!0):!1}}function fr(){let i=Number.MIN_SAFE_INTEGER;return{name:"max",operationType:k.FILTER,operation:e=>e>i?(i=e,!0):!1}}function pr(i){return{operationType:k.FILTER,name:"skipDynamic",operation:e=>i.value===0?!0:(i.update(i.value-1),!1)}}function mr(i){return{operationType:k.FILTER,name:`skip ${i}`,operation:e=>i===0?!0:(i--,!1)}}function yr(i){return{name:`cutoff ${i}`,operationType:k.FILTER,operation:e=>i===0?!1:(i--,!0)}}function gr(i){return{name:"cutoffDynamic",operationType:k.FILTER,operation:e=>i.value===0?!1:(i.update(i.value-1),!0)}}function wr(i){return{operationType:k.DELAY,name:"semaphore",operation:e=>new Promise(t=>{if(i.value>0)i.update(i.value-1),t(e);else{const n=i.listen(()=>{i.value>0&&(n(),i.update(i.value-1),t(e))})}})}}function ne(i){let e=!1,t;return{name:"unique",operationType:k.FILTER,operation:n=>e&&(i?i(t,n):n===t)?!1:(e=!0,t=n,!0)}}function br(){return{name:"await",operationType:k.MAP_DELAY,operation:i=>i}}function Ar(){const i=[],e=new I;return{operationType:k.MAP_DELAY,name:"awaitOrdered",operation:async n=>{if(i.push(n),i.length===1)return t();{const s=e.subscribe(async()=>{if(i[0]===n)return s.cancel(),t()})}}};async function t(){await i[0];const n=i.shift();return e.fire(),n}}function kr(){let i;return{operationType:k.MAP_DELAY_FILTER,name:"awaitLatest",operation:async e=>{i=Date.now();const t=i,n=await e;return i===t?{item:n,cancelled:!1}:{item:void 0,cancelled:!0}}}}function vr(i,e){let t=e;return{name:"reduce",operationType:k.MAP,operation:n=>(t=i(t,n),t)}}function Er(i=", "){let e;return{name:`stringJoin ${i}`,operationType:k.MAP,operation:t=>(e?e+=i+t:e=t,e)}}function Sr(i){return{name:`delay ${i}ms`,operationType:k.DELAY,operation:e=>new Promise(t=>{setTimeout(()=>{t(e)},i)})}}function ke(i){let e,t=new I;return{operationType:k.DELAY_FILTER,name:`debounce ${i}ms`,operation:n=>new Promise(s=>{clearTimeout(e),t.fire(),t.subscribeOnce(()=>{s(!1)}),e=setTimeout(()=>{s(!0),t.cancelAll()},i)})}}function xr(){let i;return{operationType:k.DELAY_FILTER,name:"microDebounce",operation:e=>new Promise(t=>{i?t(!1):(i=!0,queueMicrotask(()=>{i=!1,t(!0)}))})}}function Dr(){let i,e=new I;return{operationType:k.DELAY_FILTER,name:"throttle frame",operation:t=>new Promise(n=>{clearTimeout(i),e.fire(),e.subscribeOnce(()=>{n(!1)}),i=requestAnimationFrame(()=>{n(!0),e.cancelAll()})})}}function Tr(i){return{name:"lock",operationType:k.FILTER,operation:e=>!i.value}}function Cr(i){let e=!1;return{name:`throttle ${i}ms`,operationType:k.FILTER,operation:t=>e?!1:(e=!0,setTimeout(()=>{e=!1},i),!0)}}function Rr(i){let e=[],t;return{name:`buffer ${i}ms`,operationType:k.MAP_DELAY_FILTER,operation:n=>(e.push(n),t?Promise.resolve({cancelled:!0,item:void 0}):(t=new Promise(s=>{setTimeout(()=>{t=void 0,s({cancelled:!1,item:e}),e=[]},i)}),t))}}function _r(i){return{name:`pick ${i.toString()}`,operationType:k.MAP,operation:e=>e!=null?e[i]:e}}function Or(i){return{name:`pipe ${i.name}`,operationType:k.NOOP,operation:e=>(i instanceof g||i instanceof F?i.update(e):i.updateDownstream(e),e)}}function Ir(i){return{name:`pipeup ${i.name}`,operationType:k.NOOP,operation:e=>(i instanceof g||i instanceof F?i.update(e):i.updateUpstream(e),e)}}function Lr(i,e,t=new T){return{operationType:k.NOOP,name:"history",operation:n=>(t.isCancelled||(e&&i.length.value>=e&&i.removeLeft(i.length.value-e),i.push(n)),n)}}function Nr(i,e,t=new T){let n=0;return t.setInterval(()=>{i.update(n),n=0},e),{operationType:k.NOOP,name:"throughput meter",operation:s=>(n++,s)}}function je(i){return{name:"tap",operationType:k.NOOP,operation:e=>(i(e),e)}}function Mr(i){let e=0;return{name:`loadBalance [${i.map(t=>t.name).join()}]`,operationType:k.NOOP,operation:t=>{const n=i[e++];return e>=i.length&&(e=0),n instanceof g||n instanceof F?n.update(t):n.updateDownstream(t),t}}}function Ur(i="",e=""){return{name:"log",operationType:k.NOOP,operation:t=>(console.log(`${i}${t}${e}`),t)}}function Pr(...i){return{name:`pipeAll [${i.map(e=>e.name).join()}]`,operationType:k.NOOP,operation:e=>(i.forEach(t=>{t instanceof g||t instanceof F?t.update(e):t.updateDownstream(e)}),e)}}function $r(i){let e=i;return{name:"accumulate",operationType:k.MAP,operation:t=>(e+=t,e)}}var j;(function(i){i[i.UPSTREAM=0]="UPSTREAM",i[i.DOWNSTREAM=1]="DOWNSTREAM"})(j||(j={}));var W;(function(i){i[i.UPSTREAM=0]="UPSTREAM",i[i.DOWNSTREAM=1]="DOWNSTREAM",i[i.BOTH=2]="BOTH"})(W||(W={}));function Fr(i,e){return{name:"map",operationType:k.MAP,operationDown:t=>i(t),operationUp:t=>e(t)}}function zr(i,e){const t=ke(i),n=ke(i);return{operationType:k.DELAY_FILTER,name:`debounce ${i}ms`,operationDown:s=>e===void 0||e===W.DOWNSTREAM||e===W.BOTH?t.operation(s):Promise.resolve(!0),operationUp:s=>e===void 0||e===W.UPSTREAM||e===W.BOTH?n.operation(s):Promise.resolve(!0)}}function jt(i){return i===j.DOWNSTREAM?Ye(()=>!0,()=>!1):Ye(()=>!1,()=>!0)}function Ye(i,e){return{name:"filter",operationType:k.FILTER,operationDown:t=>i(t),operationUp:t=>e(t)}}function jr(i,e){let t,n,s=!1,a=!1;return{name:"filter",operationType:k.FILTER,operationDown:o=>i===void 0||i===W.DOWNSTREAM||i===W.BOTH?a&&(e?e(t,o):o===t)?!1:(a=!0,t=o,!0):!0,operationUp:o=>i===void 0||i===W.UPSTREAM||i===W.BOTH?s&&(e?e(n,o):o===n)?!1:(n=o,s=!0,!0):!0}}class C{constructor(e,t=!0,n="RootDuplexDataSource"){w(this,"value");w(this,"primed");w(this,"errorHandler");w(this,"errorEvent");w(this,"updatingUpstream");w(this,"updatingDownstream");w(this,"updateDownstreamEvent");w(this,"updateUpstreamEvent");w(this,"propagateWritesToReadStream");w(this,"name");this.name=n,this.value=e,this.primed=e!==void 0,this.updateDownstreamEvent=new I,this.updateUpstreamEvent=new I,this.propagateWritesToReadStream=t}static fromRemoteSource(e,t){const n=new C(void 0,!1);return Ut(n,e,t),n}static fromAsyncIterator(e,t){const n=new C;return(async()=>{for await(const s of e){if(t!=null&&t.isCancelled)return;n.updateDownstream(s)}})(),n}static fromPromise(e,t){const n=new C;return e.then(s=>{t!=null&&t.isCancelled||n.updateDownstream(s)},s=>{t!=null&&t.isCancelled||n.emitError(s,j.DOWNSTREAM)}),n}static fromPromiseArray(e,t){const n=new C;return(async()=>{for await(const s of ze(e,t)){if(t!=null&&t.isCancelled)return;s.status==="fulfilled"?n.updateDownstream(s.value):n.emitError(s.reason,j.DOWNSTREAM)}})(),n}toAsyncIterator(e){return this.updateDownstreamEvent.toAsyncIterator(e)}static toDuplexDataSource(e){return e instanceof C?e:new C(e)}static fromTwoDataSource(e,t,n,s=!0){const a=new C(n,s);return a.updateDownstreamEvent=e.updateEvent,a.updateUpstreamEvent=t.updateEvent,a}withInitial(e){return this.primed||this.updateDownstream(e),this}toString(){return this.value.toString()}static createOneWay(e=j.DOWNSTREAM,t){return new C(t,!1).transformDuplex(jt(e))}updateDownstream(e){if(e===this)throw new Error("Cannot update data source with itself");if(this.updatingDownstream)throw new Error("Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed");this.primed=!0,this.updatingDownstream=!0,this.value=e,this.updateDownstreamEvent.fire(e),this.updatingDownstream=!1}updateUpstream(e){if(e===this)throw new Error("Cannot update data source with itself");if(this.updatingUpstream)throw new Error("Problem in datas source: Unstable value propagation, when updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed");this.primed=!0,this.updatingUpstream=!0,this.value=e,this.updateUpstreamEvent.fire(e),this.propagateWritesToReadStream&&this.updateDownstreamEvent.fire(e),this.updatingUpstream=!1}listenAndRepeat(e,t){return this.primed&&e(this.value),this.listen(e,t)}listen(e,t){return this.listenInternal(e,t)}listenInternal(e,t){return this.updateDownstreamEvent.subscribe(e,t).cancel}listenUpstream(e,t){return this.updateUpstreamEvent.subscribe(e,t).cancel}listenUpstreamAndRepeat(e,t){return this.primed&&e(this.value),this.updateUpstreamEvent.subscribe(e,t).cancel}listenUpstreamOnce(e,t){return this.updateUpstreamEvent.subscribeOnce(e,t).cancel}listenDownstream(e,t){return this.updateDownstreamEvent.subscribe(e,t).cancel}downStreamToDataSource(e){const t=new g(this.value);return this.listenDownstream(n=>{t.update(n)},e),t}aggregate(e,t,n){var a;n=n??new T;const s=new g(t(this.value,...e.map(o=>o==null?void 0:o.value)));for(let o=0;o<e.length;o++)(a=e[o])==null||a.listen(()=>{s.update(t(this.value,...e.map(l=>l==null?void 0:l.value)))},n);return this.listen(()=>s.update(t(this.value,...e.map(o=>o==null?void 0:o.value))),n),s}transformDuplex(e,t,n,s,a,o,l,c,h,d,f,p){let m;const v=[e,t,n,s,a,o,l,c,h,d,f].filter(A=>A&&(A instanceof T?(m=A,!1):!0));p&&(m=p);const b=new C(void 0,!1,this.name+" "+v.map(A=>A.name).join(" "));return(this.primed?this.listenAndRepeat:this.listen).call(this,Ve(v,b,j.DOWNSTREAM),m),b.listenUpstream.call(b,Ve(v,this,j.UPSTREAM),m),b}transform(e,t,n,s,a,o,l,c,h,d,f,p){let m;const v=[e,t,n,s,a,o,l,c,h,d,f].filter(A=>A&&(A instanceof T?(m=A,!1):!0));p&&(m=p);const b=new g(void 0,this.name+" "+v.map(A=>A.name).join(" "));return(this.primed?this.listenAndRepeat:this.listen).call(this,Ie(v,b),m),b}combine(e,t){t=t??new T;let n;this.primed?n=new g(this.value):n=new g,this.pipe(n,t);for(const s of e)s.pipe(n,t);return n}pipe(e,t){return this.listenDownstream(n=>e.update(n),t),e.listen(n=>this.updateUpstream(n),t),this}listenOnce(e,t){return this.updateDownstreamEvent.subscribeOnce(e,t).cancel}awaitNextUpdate(e){return new Promise(t=>{this.listenOnce(n=>t(n),e)})}cancelAll(){this.updateDownstreamEvent.cancelAll(),this.updateUpstreamEvent.cancelAll()}cancelAllDownstream(){this.updateDownstreamEvent.cancelAll()}cancelAllUpstream(){this.updateUpstreamEvent.cancelAll()}handleErrors(e){return this.errorHandler=e,this}onError(e,t){return this.errorEvent.subscribe(e,t),this}emitError(e,t){if(this.errorHandler)try{return t===j.DOWNSTREAM?this.updateDownstream(this.errorHandler(e)):this.updateUpstream(this.errorHandler(e))}catch(n){e=n}if(this.errorEvent.hasSubscriptions())this.errorEvent.fire(e);else throw e}}function Ve(i,e,t){return async n=>{try{for(const s of i)switch(s.operationType){case k.NOOP:case k.MAP:n=t===j.DOWNSTREAM?s.operationDown(n):s.operationUp(n);break;case k.MAP_DELAY_FILTER:const a=t===j.DOWNSTREAM?await s.operationDown(n):await s.operationUp(n);if(a.cancelled)return;n=await a.item;break;case k.DELAY:case k.MAP_DELAY:n=t===j.DOWNSTREAM?await s.operationDown(n):await s.operationUp(n);break;case k.DELAY_FILTER:if(!(t===j.DOWNSTREAM?await s.operationDown(n):await s.operationUp(n)))return;break;case k.FILTER:if(!(t===j.DOWNSTREAM?s.operationDown(n):s.operationUp(n)))return;break}t===j.DOWNSTREAM?e.updateDownstream(n):e.updateUpstream(n)}catch(s){e.emitError(s,t)}}}class X{constructor(e){w(this,"data");w(this,"updateEvent");w(this,"updateEventOnKey");this.data=e,this.updateEvent=new I,this.updateEventOnKey=new Map}static fromRemoteSource(e,t){const n=new X(void 0);return It(n,e,t),n}static toObjectDataSource(e){return e instanceof X?e:new X(e)}toString(){return this.data.toString()}cancelAll(){this.updateEvent.cancelAll(),this.updateEventOnKey.forEach(e=>e.cancelAll())}pickObject(e,t){if(typeof this.data[e]=="object"){const n=new X(this.data[e]);return n.listen(s=>{s.deleted?delete this.data[e][s.key]:this.get(e)[s.key]=s.newValue},t),this.listenOnKey(e,s=>{typeof s.newValue=="object"?s.newValue!==n.data&&n.merge(s.newValue):n.clear()}),n}else throw new Error("Cannot pick a non object key")}pickArray(e,t){var n;if(Array.isArray(this.data[e])){const s=new D((n=this.data)==null?void 0:n[e]);return s.listen(a=>{this.set(e,a.newState)},t),this.listenOnKey(e,a=>{Array.isArray(a.newValue)?(a.newValue.length!==s.length.value||!s.getData().every((o,l)=>a.newValue[l]===o))&&s.merge(a.newValue):s.clear()}),s}else throw new Error("Cannot pick a non array key")}pick(e,t){var s;const n=new g((s=this.data)==null?void 0:s[e]);return n.listen(()=>{this.set(e,n.value)},t),this.listenOnKey(e,a=>{n.value!==a.newValue&&n.update(a.newValue)},t),n}pickDuplex(e,t){var s;const n=new C((s=this.data)==null?void 0:s[e]);return n.listenUpstream(a=>{this.set(e,a)}),this.listenOnKey(e,a=>{n.value!==a.newValue&&n.updateDownstream(a.newValue)},t),n}hasKey(e){return this.data.hasOwnProperty(e)}applyObjectChange(e){e.deleted&&this.hasKey(e.key)?this.delete(e.key):e.newValue!==this.get(e.key)&&this.set(e.key,e.newValue)}listen(e,t){return this.updateEvent.subscribe(e,t).cancel}map(e){const t=new Map,n=new D;return this.listenAndRepeat(s=>{if(s.deleted&&t.has(s.key)){const a=t.get(s.key);n.remove(a),t.delete(s.key)}else if(t.has(s.key)){const a=e(s.key,s.newValue);n.replace(t.get(s.key),a),t.set(s.key,a)}else if(!t.has(s.key)&&!s.deleted){const a=e(s.key,s.newValue);n.push(a),t.set(s.key,a)}}),n}listenAndRepeat(e,t){const n=this.updateEvent.subscribe(e,t).cancel;for(const s in this.data)e({key:s,newValue:this.data[s],oldValue:void 0,deleted:!1});return n}listenOnKeyAndRepeat(e,t,n){return t({key:e,newValue:this.data[e],oldValue:void 0}),this.listenOnKey(e,t,n)}listenOnKey(e,t,n){return this.updateEventOnKey.has(e)||this.updateEventOnKey.set(e,new I),this.updateEventOnKey.get(e).subscribe(t,n).cancel}keys(){return Object.keys(this.data)}values(){return Object.values(this.data)}get(e){return this.data[e]}delete(e){if(this.hasKey(e)){const t=this.data[e];delete this.data[e],this.updateEvent.fire({oldValue:t,key:e,newValue:void 0,deleted:!0}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire({oldValue:t,key:e,newValue:void 0})}}set(e,t){if(this.data[e]===t)return;const n=this.data[e];this.data[e]=t,this.updateEvent.fire({oldValue:n,key:e,newValue:this.data[e]}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire({oldValue:n,key:e,newValue:this.data[e]})}assign(e){if(e instanceof X)for(const t of e.keys())this.set(t,e.data[t]);else for(const t of Object.keys(e))this.set(t,e[t])}merge(e){const t=new Set(Object.keys(this.data??{}));if(e instanceof X)for(const n of e.keys())t.delete(n),this.set(n,e.data[n]);else for(const n of Object.keys(e))t.delete(n),this.set(n,e[n]);for(const n of t)this.delete(n)}clear(){if(this.data!=null)for(const e in this.data)this.delete(e)}getData(){return this.data}toObject(){return{...this.data}}toDataSource(){const e=new g(this.data);return this.listen(t=>{e.update(this.data)}),e}}function me(i){return i instanceof g||i instanceof C||i instanceof F?i.value:i instanceof D?i.getData():i}function oe(i){if(i instanceof g||i instanceof C||i instanceof F)return oe(i.value);if(i instanceof D)return oe(i.toArray());if(i instanceof X)return oe(i.getData());if(i instanceof C||i instanceof F)return oe(i.value);if(Array.isArray(i))return i.map(oe);if(i instanceof Object){const e={};for(const t in i)e[t]=oe(i[t]);return e}return i}class g{constructor(e,t="RootDataSource"){w(this,"value");w(this,"primed");w(this,"updating");w(this,"name");w(this,"updateEvent");w(this,"errorHandler");w(this,"errorEvent");this.name=t,this.value=e,ce&&Pt(this,new Error().stack),this.primed=e!==void 0,this.errorEvent=new I,this.updateEvent=new I}toString(){return this.value.toString()}static toDataSource(e){return e instanceof g?e:new g(e)}static fromEvent(e,t){const n=new g;return e.subscribe(s=>n.update(s),t),n}static fromRemoteSource(e,t){const n=new g;return Nt(n,e,t),n}static fromMultipleSources(e,t){const n=new g;for(const s of e)ce&&qe(s,n),s.listenInternal(a=>n.update(a),t);return n.name=`Combination of [${e.map(s=>s.name).join(" & ")}]`,n}static fromAsyncIterator(e,t){const n=new g;return(async()=>{try{for await(const s of e){if(t!=null&&t.isCancelled)return;n.update(s)}}catch(s){n.emitError(s)}})(),n}static fromPromise(e,t){const n=new g;return e.then(s=>{t!=null&&t.isCancelled||n.update(s)},n.emitError.bind(n)),n}static fromPromiseArray(e,t){const n=new g;return(async()=>{for await(const s of ze(e,t)){if(t!=null&&t.isCancelled)return;s.status==="fulfilled"?n.update(s.value):n.emitError(s.reason)}})(),n}toAsyncIterator(e){return this.updateEvent.toAsyncIterator(e)}tap(e,t){return this.listen(n=>{e(n)},t),this}handleErrors(e){return this.errorHandler=e,this}onError(e,t){return this.errorEvent.subscribe(e,t),this}emitError(e){if(this.errorHandler)try{return this.update(this.errorHandler(e))}catch(t){e=t}if(this.errorEvent.hasSubscriptions())this.errorEvent.fire(e);else throw e}repeatLast(){return this.update(this.value),this}update(e){if(e===this)throw new Error("Cannot update data source with itself");if(this.primed=!0,this.updating)throw new Error("Problem in data source: Unstable value propagation. When updating a value the stream was updated back as a direct response. This can lead to infinite loops and is therefore not allowed");this.updating=!0,this.value=e,this.updateEvent.fire(e),ce&&$t(this,e,new Error().stack),this.updating=!1}withInitial(e){return this.primed||this.update(e),this}listenAndRepeat(e,t){return this.primed&&e(this.value),this.listen(e,t)}listenAndRepeatInternal(e,t,n){return e(this.value),this.listenInternal(e,t,n)}listen(e,t){return ce&&Ft(this,e.toString(),new Error().stack),this.listenInternal(e,t)}listenInternal(e,t,n){return this.updateEvent.subscribe(e,t).cancel}listenOnce(e,t){return this.updateEvent.subscribeOnce(e,t).cancel}transform(e,t,n,s,a,o,l,c,h,d,f,p){let m;const v=[e,t,n,s,a,o,l,c,h,d,f].filter(A=>A&&(A instanceof T?(m=A,!1):!0));p&&(m=p);const b=new g(void 0,this.name+" "+v.map(A=>A.name).join(" "));return ce&&qe(this,b),(this.primed?this.listenAndRepeatInternal:this.listenInternal).call(this,Ie(v,b),m),this.onError(A=>b.emitError(A),m),b}static fromCombination(e,t){if(e.length===0)throw new Error("Cannot combine zero data sources");return e[0].combine(e.slice(1),t)}static fromAggregation(e,t,n){var a;n=n??new T;const s=new g(t(...e.map(o=>o==null?void 0:o.value)));for(let o=0;o<e.length;o++)(a=e[o])==null||a.listen(()=>{s.update(t(...e.map(l=>l==null?void 0:l.value)))},n);return s}aggregate(e,t,n){var a;n=n??new T;const s=new g(t(this.value,...e.map(o=>o==null?void 0:o.value)));for(let o=0;o<e.length;o++)(a=e[o])==null||a.listen(()=>{s.update(t(this.value,...e.map(l=>l==null?void 0:l.value)))},n);return this.listen(()=>s.update(t(this.value,...e.map(o=>o==null?void 0:o.value))),n),s}pipe(e,t){return this.listen(n=>e.update(n),t),this}static dynamicAggregation(e,t,n){const s=new WeakMap,a=new g;return e.listenAndRepeat(l=>{for(const c of l.items)o(c);a.update(t(e.getData().map(c=>c.value)))}),e.onItemsAdded.subscribe(l=>{for(const c of l)o(c)}),e.onItemsRemoved.subscribe(l=>{for(const c of l)s.get(c).cancel(),s.delete(c)}),a;function o(l){s.set(l,new T),l.listen(()=>{a.update(t(e.getData().map(c=>c.value)))},s.get(l))}}combine(e,t){t=t??new T;let n;this.primed?n=new g(this.value):n=new g,this.pipe(n,t);for(const s of e)s.pipe(n,t);return n}awaitNextUpdate(e){return new Promise(t=>{this.listenOnce(n=>t(n),e)})}cancelAll(){this.updateEvent.cancelAll()}}class D{constructor(e,t="RootArrayDataSource"){w(this,"data");w(this,"updateEvent");w(this,"lengthSource");w(this,"name");w(this,"onItemsAdded",new I);w(this,"onItemsRemoved",new I);this.name=t,e?this.data=e.slice():this.data=[],this.lengthSource=new g(this.data.length,this.name+".length"),this.updateEvent=new I}*[Symbol.iterator](){yield*this.getData()}pickAt(e,t){if(e<0)throw new Error("Index out of bounds");const n=new g(this.data[e],this.name+`[${e}]`);return this.listen(s=>{n.value!==s.newState[e]&&n.update(s.newState[e])},t),n}toSetDataSource(e){const t=new B;return this.listenAndRepeat(n=>{switch(n.operation){case"add":for(const s of n.items)t.add(s);break;case"remove":for(const s of n.items)this.includes(s)||t.delete(s);break;case"replace":this.includes(n.target)||t.delete(n.target);for(const s of n.items)t.add(s);break;case"merge":t.clear();for(const s of n.items)t.add(s);break}},e),t}toString(){return this.data.toString()}static fromFetchText(e,t={itemSeperatorSequence:`
`}){const n=new TextDecoder("utf-8"),s=new D,{onComplete:a,itemSeperatorSequence:o}=t;let l="";const c=e.body.getReader();function h(d){d.read().then(({done:f,value:p})=>{if(f)l.length&&s.push(l),a==null||a();else{const m=(l+n.decode(p)).split(o);l=m.splice(m.length-1,1)[0],s.appendArray(m),h(d)}})}return h(c),s}static fromFetchJSON(e,t={itemSeperatorSequence:`
`}){const n=new TextDecoder("utf-8"),s=new D,{onParseError:a,onComplete:o,itemSeperatorSequence:l=`
`}=t;let c="";const h=e.body.getReader();function d(p){p.read().then(({done:m,value:v})=>{if(m)c.length&&f(c),o==null||o();else{const b=(c+n.decode(v)).split(l);c=b.splice(b.length-1,1)[0];for(const A of b)f(A);d(p)}})}d(h);function f(p){try{s.push(JSON.parse(p))}catch{try{s.push(a(p))}catch{}}}return s}static fromRemoteSource(e,t){const n=new D;return Mt(n,e,t),n}static fromMultipleSources(e,t){const n=[0],s=new D(void 0,`ArrayDataSource of (${e.reduce((a,o)=>a+(o instanceof D?o.name+" ":""),"")})`);for(let a=0;a<e.length;a++){const o=e[a];if(Array.isArray(o))s.appendArray(o);else if(o instanceof g||o instanceof C){let l=a;o.transform(pt(),je(({newValue:c,oldValue:h})=>{let d=0,f=0,p=0;if(Array.isArray(h)?(f=h.length,d-=h.length):h!==void 0&&(f=1,d--),Array.isArray(c)?(d+=c.length,p=c.length):c!==void 0&&(d++,p=1),Array.isArray(c))for(let m=0;m<c.length;m++)m<f?s.set(n[l]+m,c[m]):s.insertAt(n[l]+m,c[m]);else c!==void 0&&(p<=f?s.set(n[l],c):s.insertAt(n[l],c));for(let m=0;m<f-p;m++)s.removeAt(n[l]+p);for(let m=l+1;m<n.length;m++)n[m]+=d}),t)}else{s.appendArray(e[a].data??[]);let l=a;e[a].listen(c=>{switch(c.operationDetailed){case"append":case"prepend":case"insert":s.insertAt(c.index+n[l],...c.items);for(let d=l+1;d<n.length;d++)n[d]+=c.count;break;case"remove":case"removeLeft":case"removeRight":case"clear":s.removeRange(c.index+n[l],c.index+n[l]+c.count);for(let d=l+1;d<n.length;d++)n[d]-=c.count;break;case"merge":const h=c.newState.length+c.previousState.length;if(s.removeRange(c.index+n[l],c.index+n[l]+c.previousState.length),s.insertAt(c.index+n[l],...c.newState),h!=0)for(let d=l+1;d<n.length;d++)n[d]+=h;break;case"replace":s.set(c.index+n[l],c.items[0]);break;case"swap":s.swap(c.index+n[l],c.index2+n[l]);break}},t)}n.push(s.length.value)}return s}static DynamicArrayDataSourceToArrayDataSource(e,t){const n=new D,s=new WeakMap;return e.listenAndRepeat(({operationDetailed:l,index:c,index2:h,count:d,items:f,previousState:p,newState:m,target:v})=>{switch(l){case"append":for(const b of f)a(b);n.appendArray(f.map(b=>me(b)));break;case"prepend":for(const b of f)a(b);n.unshift(...f.map(b=>me(b)));break;case"merge":for(const b of p)o(b);for(const b of m)a(b);n.merge(m.map(b=>me(b)));break;case"insert":for(const b of f)a(b);n.insertAt(c,...f.map(b=>me(b)));break;case"clear":for(const b of p)o(b);n.clear();break;case"remove":for(const b of f)o(b);n.removeRange(c,c+d);break;case"removeLeft":for(const b of f)o(b);n.removeLeft(d);break;case"removeRight":for(const b of f)o(b);n.removeRight(d);break;case"replace":o(v),a(f[0]),n.set(c,me(f[0]));break;case"swap":n.swap(c,h);break}},t),n;function a(l){typeof l!="object"||!("listen"in l)||(s.set(l,new T),t.chain(s.get(l)),l.listen(c=>{n.set(e.indexOf(l),c)},s.get(l)))}function o(l){s.has(l)&&(s.get(l).cancel(),s.delete(l))}}static fromAsyncIterator(e,t){const n=new D;return(async()=>{for await(const s of e){if(t!=null&&t.isCancelled)return;n.push(s)}})(),n}static fromPromiseArray(e,t){const n=new D;return(async()=>{for await(const s of ze(e,t)){if(t!=null&&t.isCancelled)return;n.push(s)}})(),n}toAsyncIterator(e){return this.updateEvent.toAsyncIterator(e)}static toArrayDataSource(e){return e instanceof D?e:new D(e)}pipe(e,t){this.listenAndRepeat(n=>e.applyCollectionChange(n),t)}cancelAll(){this.onItemsAdded.cancelAll(),this.onItemsRemoved.cancelAll(),this.updateEvent.cancelAll()}listenAndRepeat(e,t){return this.data.length&&e({operation:"add",operationDetailed:"append",index:0,items:this.data,newState:this.data,count:this.data.length}),this.listen(e,t)}repeatCurrentState(){this.update({operation:"remove",operationDetailed:"clear",count:this.data.length,index:0,items:this.data,newState:[]}),this.update({operation:"add",operationDetailed:"append",index:0,items:this.data,newState:this.data,count:this.data.length})}listen(e,t){return this.updateEvent.subscribe(e,t).cancel}listenOnce(e,t){return this.updateEvent.subscribeOnce(e,t).cancel}applyCollectionChange(e){switch(e.operationDetailed){case"append":this.appendArray(e.items);break;case"clear":this.clear();break;case"insert":this.insertAt(e.index,...e.items);break;case"merge":this.merge(e.items);break;case"prepend":this.unshift(...e.items);break;case"remove":this.removeRange(e.index,e.index+e.count);break;case"removeLeft":this.removeLeft(e.count);break;case"removeRight":this.removeRight(e.count);break;case"replace":this.set(e.index,e.items[0]);break;case"swap":this.swap(e.index,e.index2);break}}awaitNextUpdate(e){return new Promise(t=>{this.listenOnce(n=>t(n),e)})}get length(){return this.lengthSource}getData(){return this.data}get(e){return this.data[e]}set(e,t){const n=this.data[e];n!==t&&(this.data[e]=t,this.update({operation:"replace",operationDetailed:"replace",target:n,count:1,index:e,items:[t],newState:this.data}),this.onItemsRemoved.fire([n]),this.onItemsAdded.fire([t]),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length))}indexOf(e){return this.data.indexOf(e)}find(e,t){return this.data.find(e,t)}findIndex(e,t){return this.data.findIndex(e,t)}lastIndexOf(e){return this.data.lastIndexOf(e)}includes(e){return this.data.includes(e)}replace(e,t){const n=this.indexOf(e);n!==-1&&this.set(n,t)}swap(e,t){if(e===t)return;const n=this.data[e],s=this.data[t];this.data[t]=n,this.data[e]=s,this.update({operation:"swap",operationDetailed:"swap",index:e,index2:t,items:[n,s],newState:this.data}),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length)}swapItems(e,t){if(e===t)return;const n=this.data.indexOf(e),s=this.data.indexOf(t);n!==-1&&s!==-1&&(this.data[s]=e,this.data[n]=t),this.update({operation:"swap",operationDetailed:"swap",index:n,index2:s,items:[e,t],newState:this.data}),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length)}appendArray(e){!e||e.length===0||(e.length<=65e3?this.data.push.apply(this.data,e):(console.warn("Appending over 65000 items in one go can lead to performance issues. Consider streaming your changes progressively"),this.data=this.data.concat(e)),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"add",operationDetailed:"append",count:e.length,index:this.data.length-e.length,items:e,newState:this.data}),this.onItemsAdded.fire(e))}splice(e,t,...n){let s=[];return t>0&&(s=this.removeAt(e,t)),n&&n.length>0&&this.insertAt(e,...n),s}insertAt(e,...t){t.length!==0&&(this.data.splice(e,0,...t),this.update({operation:"add",operationDetailed:"insert",count:t.length,index:e,items:t,newState:this.data}),this.onItemsAdded.fire(t),this.lengthSource.update(this.data.length))}push(...e){this.appendArray(e)}unshift(...e){this.data.unshift(...e),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"add",operationDetailed:"prepend",count:e.length,items:e,index:0,newState:this.data}),this.onItemsAdded.fire(e)}pop(){const e=this.data.pop();return this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"removeRight",count:1,index:this.data.length,items:[e],newState:this.data}),this.onItemsRemoved.fire([e]),e}merge(e){if(e.length===0)return this.clear();if(e===this.data)return;if(e.every((n,s)=>n===this.data[s]))if(this.data.length>e.length){this.removeRight(this.data.length-e.length);return}else return;const t=this.data;this.data=e.slice(),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"merge",operationDetailed:"merge",previousState:t,index:0,items:this.data,newState:this.data}),this.onItemsRemoved.fire(t),this.onItemsAdded.fire(this.data)}removeRight(e){const t=this.data.length,n=this.data.splice(t-e,e);return this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"removeRight",count:e,index:t-e,items:n,newState:this.data}),this.onItemsRemoved.fire(n),n}removeLeft(e){const t=this.data.splice(0,e);this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"removeLeft",count:e,index:0,items:t,newState:this.data}),this.onItemsRemoved.fire(t)}removeWhere(e){const t=this.data.filter(e);for(const n of t)this.remove(n)}removeAt(e,t=1){const n=this.data.splice(e,t);return this.update({operation:"remove",operationDetailed:"remove",count:n.length,index:e,items:n,newState:this.data}),this.onItemsRemoved.fire(n),this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),n}removeRange(e,t){const n=this.data.splice(e,t-e);return this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"remove",count:n.length,index:e,items:n,newState:this.data}),this.onItemsRemoved.fire(n),n}remove(e){const t=this.data.indexOf(e);if(t!==-1)return this.removeAt(t)[0]}clear(){if(this.data.length===0)return;const e=this.data;this.data=[],this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"clear",count:e.length,index:0,items:e,previousState:e,newState:this.data}),this.onItemsRemoved.fire(e)}some(e){return this.data.some(e)}every(e){return this.data.every(e)}shift(){const e=this.data.shift();return this.lengthSource.value!==this.data.length&&this.lengthSource.update(this.data.length),this.update({operation:"remove",operationDetailed:"removeLeft",items:[e],count:1,index:0,newState:this.data}),this.onItemsRemoved.fire([e]),e}toArray(){return this.data.slice()}flat(e,t){return new Bt(this,1,e,this.name+".flat()",t)}reduce(e,t,n){const s=new g(t);return this.listenAndRepeat(a=>{switch(a.operationDetailed){case"append":let o=s.value;for(const c of a.items)o=e(o,c);s.update(o);break;case"clear":s.update(t);break;case"removeRight":case"removeLeft":case"prepend":case"insert":case"merge":case"replace":case"swap":case"remove":let l=t;for(const c of a.newState)l=e(l,c);s.update(l);break}},n),s}reverse(e,t){return new Ht(this,e,this.name+".reverse()",t)}sort(e=(a,o)=>a==null?1:o==null?-1:typeof a=="number"&&typeof o=="number"?a-o:a.toString().localeCompare(o.toString()),t=[],n,s){const a=new Yt(this,e,n,this.name+".sort()",s);return t.forEach(o=>{o.listen(()=>a.refresh())},n),a}slice(e,t,n,s){return typeof e=="number"&&(e=new g(e)),typeof t=="number"&&(t=new g(t)),t===void 0&&(t=this.length),new Wt(this,e,t,n,this.name+".slice()",s)}map(e,t=[],n,s){const a=new Kt(this,e,n,this.name+".map()",s);return t.forEach(o=>{o.listen(()=>a.refresh())},n),a}unique(e,t){return new qt(this,e,this.name+".unique()",t)}indexBy(e,t,n){const s=new z;return this.listenAndRepeat(a=>{var o;if(!((o=n==null?void 0:n.ignoredOperations)!=null&&o.includes(a.operationDetailed)))switch(a.operation){case"add":for(const h of a.items)s.set(h[e],h);break;case"remove":for(const h of a.items)s.delete(h[e]);break;case"replace":s.delete(a.target[e]),s.set(a.items[0][e],a.items[0]);break;case"merge":const l=new Set(s.keys()),c=new Set(a.items.map(h=>h[e]));for(const h of l)c.has(h)||s.delete(h);for(const h of c)l.has(h)||s.set(h,a.items.find(d=>d[e]===h));break}},t),s}indexByProvider(e,t,n){const s=new z;return this.listenAndRepeat(a=>{var o;if(!((o=n==null?void 0:n.ignoredOperations)!=null&&o.includes(a.operationDetailed)))switch(a.operation){case"add":for(const h of a.items)s.set(e(h),h);break;case"remove":for(const h of a.items)s.delete(e(h));break;case"replace":s.delete(e(a.target)),s.set(e(a.items[0]),a.items[0]);break;case"merge":const l=new Set(s.keys()),c=new Set(a.items.map(h=>e(h)));for(const h of l)c.has(h)||s.delete(h);for(const h of c)l.has(h)||s.set(h,a.items.find(d=>e(d)===h));break}},t),s}groupBy(e,t,n){const s=new z;function a(l){const c=s.get(l[e]);c.splice(c.indexOf(l),1),c.length.value===0&&s.delete(l[e])}function o(l){s.has(l[e])||s.set(l[e],new D),s.get(l[e]).push(l)}return this.listenAndRepeat(l=>{var c;if(!((c=n==null?void 0:n.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operation){case"add":for(const d of l.items)o(d);break;case"remove":for(const d of l.items)a(d);break;case"replace":a(l.target),o(l.items[0]);break;case"merge":const h=l.previousState.filter(d=>!l.newState.includes(d));for(const d of h)s.has(d[e])&&s.get(d[e]).includes(d)&&a(d);for(const d of l.items)s.has(d[e])&&s.get(d[e]).includes(d)||o(d);break}},t),s}groupByProvider(e,t,n){const s=new z;function a(l){const c=s.get(e(l));c.splice(c.indexOf(l),1),c.length.value===0&&s.delete(e(l))}function o(l){s.has(e(l))||s.set(e(l),new D),s.get(e(l)).push(l)}return this.listenAndRepeat(l=>{var c;if(!((c=n==null?void 0:n.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operation){case"add":for(const d of l.items)o(d);break;case"remove":for(const d of l.items)a(d);break;case"replace":a(l.target),o(l.items[0]);break;case"merge":const h=l.previousState.filter(d=>!l.newState.includes(d));for(const d of h)s.has(e(d))&&s.get(e(d)).includes(d)&&a(d);for(const d of l.items)s.has(e(d))&&s.get(e(d)).includes(d)||o(d);break}},t),s}groupByMultiProvider(e,t,n){const s=new z;function a(l){for(const c of e(l)){const h=s.get(c);h.splice(h.indexOf(l),1),h.length.value===0&&s.delete(c)}}function o(l){for(const c of e(l))s.has(c)||s.set(c,new D),s.get(c).push(l)}return this.listenAndRepeat(l=>{var c;if(!((c=n==null?void 0:n.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operation){case"add":for(const d of l.items)o(d);break;case"remove":for(const d of l.items)a(d);break;case"replace":a(l.target),o(l.items[0]);break;case"merge":const h=l.previousState.filter(d=>!l.newState.includes(d));for(const d of h)for(const f of e(d))s.has(f)&&s.get(f).includes(d)&&a(d);for(const d of l.items)for(const f of e(d))s.has(f)&&s.get(f).includes(d)||o(d);break}},t),s}filter(e,t=[],n,s){const a=new mt(this,e,n,this.name+".filter()",s);return t.forEach(o=>{o.listen(()=>a.refresh(),n)}),a}limit(e,t){return new Vt(this,e,t,this.name+".limit()")}forEach(e){return this.data.forEach(e)}update(e){this.updateEvent.fire(e)}}class Bt extends D{constructor(t,n,s=new T,a,o){super([],a);w(this,"parent");w(this,"depth");w(this,"sessionToken");this.depth=n,this.parent=t,this.refresh(),t.listen(l=>{var c;if(!((c=o==null?void 0:o.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operationDetailed){case"removeLeft":case"removeRight":case"remove":case"swap":case"replace":case"insert":case"merge":case"prepend":case"append":this.refresh();break;case"clear":this.clear();break}},s)}refresh(){this.sessionToken&&(this.sessionToken.cancel(),this.sessionToken=void 0);const t=this.parent.getData();if(t.length>0)if(t[0]instanceof D){this.sessionToken=new T;const n=D.fromMultipleSources(t);n.listen(s=>{this.applyCollectionChange(s)},this.sessionToken),this.merge(n.getData())}else this.merge(t.flat(this.depth))}}class Kt extends D{constructor(t,n,s=new T,a,o){const l=t.getData().map(n);super(l,a);w(this,"parent");w(this,"mapper");this.parent=t,this.mapper=n,t.listen(c=>{var h;if(!((h=o==null?void 0:o.ignoredOperations)!=null&&h.includes(c.operationDetailed)))switch(c.operationDetailed){case"removeLeft":this.removeLeft(c.count);break;case"removeRight":this.removeRight(c.count);break;case"remove":for(let p=0;p<c.items.length;p++)this.remove(this.data[c.index+p]);break;case"clear":this.clear();break;case"prepend":this.unshift(...c.items.map(this.mapper));break;case"append":this.appendArray(c.items.map(this.mapper));break;case"insert":this.insertAt(c.index,...c.items.map(this.mapper));break;case"swap":this.swap(c.index,c.index2);break;case"replace":this.set(c.index,this.mapper(c.items[0]));break;case"merge":const d=this.data.slice(),f=c.previousState.slice();for(let p=0;p<c.newState.length;p++)if(this.data.length<=p)this.data.push(this.mapper(c.newState[p])),f.push(c.newState[p]);else if(f[p]!==c.newState[p]){const m=f.indexOf(c.newState[p],p);if(m!==-1){const v=this.data[p],b=this.data[m];this.data[p]=b,this.data[m]=v;const A=f[p],R=f[m];f[p]=R,f[m]=A}else this.data.splice(p,0,this.mapper(c.newState[p])),f.splice(p,0,c.newState[p])}this.data.length>c.newState.length&&(this.data.length=c.newState.length),this.length.update(this.data.length),this.update({operation:"merge",operationDetailed:"merge",previousState:d,index:0,items:this.data,newState:this.data}),this.onItemsRemoved.fire(d),this.onItemsAdded.fire(this.data);break}},s)}refresh(){this.merge(this.parent.getData().map(this.mapper))}}class Ht extends D{constructor(t,n=new T,s,a){const o=t.getData().slice().reverse();super(o,s);w(this,"parent");this.parent=t,t.listen(l=>{var c;if(!((c=a==null?void 0:a.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operationDetailed){case"removeLeft":this.removeRight(l.count);break;case"removeRight":this.removeLeft(l.count);break;case"remove":for(const h of l.items)this.remove(h);break;case"clear":this.clear();break;case"prepend":this.appendArray(l.items.reverse());break;case"append":this.unshift(...l.items.reverse());break;case"insert":this.merge(l.newState.slice().reverse());break;case"merge":this.merge(l.items.slice().reverse());break;case"swap":this.merge(l.newState.slice().reverse());break;case"replace":this.merge(l.newState.slice().reverse());break}},n)}refresh(){this.merge(this.parent.getData().slice().reverse())}}class Wt extends D{constructor(e,t,n,s=new T,a,o){const l=e.getData().slice(t.value,n.value);super(l,a),t.listen(()=>this.merge(e.getData().slice(t.value,n.value)),s),n.listen(()=>this.merge(e.getData().slice(t.value,n.value)),s),e.listen(c=>{var h;if(!((h=o==null?void 0:o.ignoredOperations)!=null&&h.includes(c.operationDetailed)))switch(c.operationDetailed){case"removeLeft":case"removeRight":case"remove":case"append":case"prepend":case"insert":case"swap":case"replace":case"merge":this.merge(e.getData().slice(t.value,n.value));break;case"clear":this.clear();break}},s)}}class qt extends D{constructor(e,t=new T,n,s){const a=Array.from(new Set(e.getData()));super(a,n);let o;e.listen(l=>{var c;if(!((c=s==null?void 0:s.ignoredOperations)!=null&&c.includes(l.operationDetailed)))switch(l.operationDetailed){case"removeLeft":case"removeRight":case"remove":for(const h of l.items)l.newState.includes(h)||this.remove(h);break;case"clear":this.clear();break;case"prepend":o=l.items.filter(h=>!this.data.includes(h)),this.unshift(...o);break;case"append":o=l.items.filter(h=>!this.data.includes(h)),this.appendArray(o);break;case"insert":o=l.items.filter(h=>!this.data.includes(h)),this.insertAt(l.index,...o);break;case"merge":this.merge(Array.from(new Set(e.getData())));break;case"swap":this.swap(l.index,l.index2);break;case"replace":this.data.includes(l.items[0])?this.remove(l.target):this.set(l.index,l.items[0]);break}},t)}}class Yt extends D{constructor(t,n,s=new T,a,o){const l=t.getData().slice().sort(n);super(l,a);w(this,"comparator");w(this,"parent");this.parent=t,this.comparator=n,t.listen(c=>{var h;if(!((h=o==null?void 0:o.ignoredOperations)!=null&&h.includes(c.operationDetailed)))switch(c.operationDetailed){case"removeLeft":case"removeRight":case"remove":for(const d of c.items)this.remove(d);break;case"clear":this.clear();break;case"prepend":this.unshift(...c.items),this.data.sort(this.comparator);break;case"append":this.appendSorted(c.items);break;case"insert":this.appendSorted(c.items);break;case"merge":this.merge(c.items.slice().sort(this.comparator));break;case"swap":break;case"replace":this.remove(c.target),this.appendSorted(c.items);break}},s)}appendSorted(t){t.length===1&&this.data.length===0?this.push(t[0]):this.merge(this.data.concat(t).sort(this.comparator))}refresh(){this.merge(this.parent.getData().slice().sort(this.comparator))}}class mt extends D{constructor(t,n,s=new T,a,o){Array.isArray(t)&&(t=new D(t)),n=n??(()=>!0);const l=t.data.filter(n);super(l,a);w(this,"viewFilter");w(this,"parent");this.parent=t,this.viewFilter=n,t.listen(c=>{var d;if((d=o==null?void 0:o.ignoredOperations)!=null&&d.includes(c.operationDetailed))return;let h;switch(c.operationDetailed){case"clear":this.clear();break;case"removeLeft":case"removeRight":case"remove":for(const v of c.items)this.remove(v);break;case"prepend":h=c.items.filter(this.viewFilter),this.unshift(...h);break;case"append":h=c.items.filter(this.viewFilter),this.appendArray(h);break;case"insert":h=c.items.filter(this.viewFilter),this.insertAt(c.index,...h);break;case"merge":this.merge(c.items.filter(this.viewFilter));break;case"swap":const f=this.data.indexOf(c.items[0]),p=this.data.indexOf(c.items[1]);f!==-1&&p!==-1&&this.swap(f,p);break;case"replace":const m=this.data.indexOf(c.target);m!==-1&&(this.viewFilter(c.items[0])?this.set(m,c.items[0]):this.remove(c.target));break}},s)}updateFilter(t){return this.viewFilter===t?this.data.length:(this.viewFilter=t,this.refresh(),this.data.length)}refresh(){this.merge(this.parent.data.filter(this.viewFilter))}}class Vt extends D{constructor(e,t,n=new T,s){Array.isArray(e)&&(e=new D(e));const a=e.data.slice(0,t);super(a,s),e.listen(o=>{switch(o.operationDetailed){case"clear":this.clear();break;case"removeLeft":case"removeRight":case"remove":o.index<t&&(this.removeRange(o.index,o.index+Math.min(t,o.count)),this.data.length<t&&this.appendArray(o.newState.slice(this.data.length,t)));break;case"prepend":this.removeRight(Math.min(o.count,t)),this.unshift(...o.items.slice(0,t));break;case"append":this.data.length<t&&this.appendArray(o.items.slice(0,t-this.data.length));break;case"insert":o.index<t&&(this.removeRight(Math.min(o.count,t-o.index)),this.insertAt(o.index,...o.items.slice(0,t-o.index)));break;case"merge":case"swap":this.merge(o.newState.slice(0,t));break;case"replace":o.index<t&&this.set(o.index,o.items[0]);break}},n)}}function Ie(i,e){return async t=>{try{for(const n of i)switch(n.operationType){case k.NOOP:case k.MAP:t=n.operation(t);break;case k.MAP_DELAY_FILTER:const s=await n.operation(t);if(s.cancelled)return;t=await s.item;break;case k.DELAY:case k.MAP_DELAY:t=await n.operation(t);break;case k.DELAY_FILTER:if(!await n.operation(t))return;break;case k.FILTER:if(!n.operation(t))return;break}e.update(t)}catch(n){e.emitError(n)}}}class z{constructor(e){w(this,"data");w(this,"updateEvent");w(this,"updateEventOnKey");this.data=e??new Map,this.updateEvent=new I,this.updateEventOnKey=new Map}cancelAll(){this.updateEvent.cancelAll(),this.updateEventOnKey.forEach((e,t)=>e.cancelAll()),this.updateEventOnKey.clear()}static fromRemoteSource(e,t){const n=new z;return Lt(n,e,t),n}static fromMultipleMaps(e,t){const n=new z;let s=0;for(const a of e){let o=s;n.assign(a),a.listen(l=>{let c=!1;for(let h=o+1;h<e.length;h++)if(e[h].has(l.key)){c=!0;break}c||(l.deleted?n.delete(l.key):n.set(l.key,l.newValue))},t)}return n}toAsyncIterator(e){return this.updateEvent.toAsyncIterator(e)}pipe(e,t){this.listenAndRepeat(n=>e.applyMapChange(n),t)}forEach(e,t){this.data.forEach(e,t)}toString(){return this.data.toString()}static toMapDataSource(e){return e instanceof z?e:new z(e)}applyMapChange(e){e.deleted&&this.data.has(e.key)?this.delete(e.key):!e.deleted&&!this.data.has(e.key)&&this.set(e.key,e.newValue)}pick(e,t){const n=new g(this.data.get(e));return this.listenOnKey(e,s=>{n.update(s.newValue)},t),n}listen(e,t){return this.updateEvent.subscribe(e,t).cancel}listenAndRepeat(e,t){const n=this.updateEvent.subscribe(e,t).cancel;for(const s of this.data.keys())e({key:s,newValue:this.data.get(s),oldValue:void 0,deleted:!1});return n}map(e,t){const n=new z,s=new Map;return this.listenAndRepeat(a=>{if(a.deleted)s.get(a.key).cancel(),s.delete(a.key),n.delete(a.key);else{const o=new T;s.has(a.key)&&s.get(a.key).cancel(),s.set(a.key,o);const l=e(a.key,a.newValue,o);n.set(a.key,l)}},t),n}toKeysArrayDataSource(e){const t=new D;return this.listenAndRepeat(n=>{n.deleted?t.remove(n.key):n.deleted||t.includes(n.key)||t.push(n.key)},e),t}toArrayDataSource(e){const t=new Map,n=new D;return this.listenAndRepeat(s=>{if(s.deleted&&t.has(s.key)){const a=t.get(s.key);n.remove(a),t.delete(s.key)}else if(t.has(s.key)){const a=s.newValue;n.replace(t.get(s.key),a),t.set(s.key,a)}else if(!t.has(s.key)&&!s.deleted){const a=s.newValue;n.push(a),t.set(s.key,a)}},e),n}toEntriesArrayDataSource(e){const t=new Map,n=new D;return this.listenAndRepeat(s=>{if(s.deleted&&t.has(s.key)){const a=n.findIndex(o=>o[0]===s.key);n.removeAt(a),t.delete(s.key)}else if(t.has(s.key)){const a=s.newValue,o=n.findIndex(l=>l[0]===s.key);n.set(o,[s.key,a]),t.set(s.key,a)}else if(!t.has(s.key)&&!s.deleted){const a=s.newValue;n.push([s.key,a]),t.set(s.key,a)}},e),n}clear(){for(const e of this.data.keys())this.delete(e)}listenOnKeyAndRepeat(e,t,n){return t({key:e,newValue:this.data.get(e),oldValue:void 0}),this.listenOnKey(e,t,n)}listenOnKey(e,t,n){return this.updateEventOnKey.has(e)||this.updateEventOnKey.set(e,new I),this.updateEventOnKey.get(e).subscribe(t,n).cancel}keys(){return this.data.keys()}values(){return this.data.values()}get(e){return this.data.get(e)}has(e){return this.data.has(e)}delete(e){if(!this.has(e))return;const t=this.data.get(e);this.data.delete(e),this.updateEvent.fire({oldValue:t,key:e,newValue:void 0,deleted:!0}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire({oldValue:t,key:e,newValue:void 0})}set(e,t){if(this.data.get(e)===t)return;const n=this.data.get(e);this.data.set(e,t),this.updateEvent.fire({oldValue:n,key:e,newValue:this.data.get(e)}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire({oldValue:n,key:e,newValue:this.data.get(e)})}merge(e){for(const t of e.keys())this.set(t,e.get(t));for(const t of this.keys())e.has(t)||this.delete(t)}entries(){return this.data.entries()}assign(e){for(const t of e.keys())this.set(t,e.get(t))}toMap(){return new Map(this.data.entries())}}class B{constructor(e){w(this,"data");w(this,"updateEvent");w(this,"updateEventOnKey");Array.isArray(e)?this.data=new Set(e):this.data=e??new Set,this.updateEvent=new I,this.updateEventOnKey=new Map}static fromRemoteSource(e,t){const n=new B(void 0);return Ot(n,e,t),n}static fromAsyncIterator(e,t){const n=new B;return(async()=>{for await(const s of e){if(t!=null&&t.isCancelled)return;n.add(s)}})(),n}toAsyncIterator(e){return this.updateEvent.toAsyncIterator(e)}cancelAll(){this.updateEvent.cancelAll()}applySetChange(e){e.exists&&!this.has(e.key)?this.data.add(e.key):!e.exists&&this.has(e.key)&&this.data.delete(e.key)}clear(){for(const e of this.data.keys())this.delete(e)}isSubsetOf(e){for(const t of this)if(!e.has(t))return!1;return!0}isSupersetOf(e){for(const t of e)if(!this.has(t))return!1;return!0}isDisjointWith(e){for(const t of e)if(this.has(t))return!1;return!0}get size(){return this.data.size}isIdenticalTo(e){if(this.size!==e.size)return!1;for(const t of e)if(!this.has(t))return!1;return!0}static toSetDataSource(e){return e instanceof B?e:new B(e)}[Symbol.iterator](){return this.data.keys()}entries(){return this.data.entries()}values(){return this.data.values()}difference(e,t){const n=new B,s=new Set(e.keys());return this.listenAndRepeat(a=>{a.exists&&!s.has(a.key)&&n.add(a.key),a.exists||n.delete(a.key)},t),e.listenAndRepeat(a=>{a.exists&&n.delete(a.key),!a.exists&&this.has(a.key)&&n.add(a.key)},t),n}union(e,t){const n=new B;return this.listenAndRepeat(s=>{s.exists?n.add(s.key):e.has(s.key)||n.delete(s.key)},t),e.listenAndRepeat(s=>{s.exists?n.add(s.key):this.has(s.key)||n.delete(s.key)},t),n}intersection(e,t){const n=new B;return this.listenAndRepeat(s=>{s.exists&&e.has(s.key)?n.add(s.key):n.delete(s.key)},t),e.listenAndRepeat(s=>{s.exists&&this.has(s.key)?n.add(s.key):n.delete(s.key)},t),n}symmetricDifference(e,t){const n=new B;return this.listenAndRepeat(s=>{s.exists&&!e.has(s.key)||!s.exists&&e.has(s.key)?n.add(s.key):(s.exists&&e.has(s.key)||!s.exists&&!e.has(s.key))&&n.delete(s.key)},t),e.listenAndRepeat(s=>{s.exists&&!this.has(s.key)||!s.exists&&this.has(s.key)?n.add(s.key):(s.exists&&this.has(s.key)||!s.exists&&!this.has(s.key))&&n.delete(s.key)},t),n}toString(){return this.data.toString()}pick(e,t){const n=new g(this.data.has(e));return this.listenOnKey(e,s=>{n.update(s)},t),n}listen(e,t){return this.updateEvent.subscribe(e,t).cancel}listenAndRepeat(e,t){const n=this.updateEvent.subscribe(e,t).cancel;for(const s of this.data.keys())e({key:s,exists:!0});return n}listenOnKeyAndRepeat(e,t,n){return t(this.has(e)),this.listenOnKey(e,t,n)}listenOnKey(e,t,n){return this.updateEventOnKey.has(e)||this.updateEventOnKey.set(e,new I),this.updateEventOnKey.get(e).subscribe(t,n).cancel}toArrayDataSource(e){return this.map(t=>t,e)}map(e,t){const n=new Map,s=new D;return this.listenAndRepeat(a=>{if(!a.exists&&n.has(a.key)){const o=n.get(a.key);s.remove(o),n.delete(a.key)}else if(!n.has(a.key)&&a.exists){const o=e(a.key);s.push(o),n.set(a.key,o)}},t),s}keys(){return this.data.keys()}has(e){return this.data.has(e)}pickKey(e,t){const n=new g(this.has(e));return this.listenOnKey(e,s=>n.update(s),t),n}delete(e){this.has(e)&&(this.data.delete(e),this.updateEvent.fire({key:e,exists:!1}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire(!1))}add(e){this.data.has(e)||(this.data.add(e),this.updateEvent.fire({key:e,exists:!0}),this.updateEventOnKey.has(e)&&this.updateEventOnKey.get(e).fire(!0))}merge(e){let t;e instanceof B?t=e.data:e instanceof Set?t=e:e instanceof D?t=new Set(e.getData()):t=new Set(e);for(const n of this.data)t.has(n)||this.delete(n);for(const n of t)this.add(n)}assign(e){for(const t of e.keys())this.add(t)}toSet(){return new Set(this.data.keys())}toArray(){return Array.from(this.data.keys())}}function Br(i,e,t,n,s,a,o,l,c,h,d){const f=new g(!1),p=[i,e,t,n,s,a,o,l,c,h,d].filter(v=>v!==void 0),m=[];return f.listen(v=>{v||m.length>0&&queueMicrotask(async()=>{if(!f.value){f.update(!0);const b=m.shift();try{const A=await Me(p,b.value);b.resolve(A)}catch(A){b.reject(A)}finally{f.update(!1)}}})}),{name:`CriticalSection<${p.map(v=>v.name).join(", ")}>`,operationType:k.MAP_DELAY_FILTER,operation:async v=>{if(!f.value){f.update(!0);try{return await Me(p,v)}finally{f.update(!1)}}return new Promise((b,A)=>{m.push({resolve:b,reject:A,value:v})})}}}function Kr(i,e,t,n,s,a,o,l,c,h){const d=[e,t,n,s,a,o,l,c,h].filter(f=>f!==void 0);return{name:"fork-inline",operationType:k.MAP_DELAY_FILTER,operation:async f=>i(f)?Me(d,f):{item:f,cancelled:!1}}}async function Me(i,e){let t,n,s=!1;const a=new g;if(a.listen(o=>{t=o,s=!0}),a.handleErrors(o=>{n=o}),await Ie(i,a)(e),n)throw n;return{item:t,cancelled:!s}}function Jt(i,e){return i instanceof z?Zt(i,e):Gt(i,e)}function Gt(i,e){const t=[];for(const n in i)if(i[n])if(i[n]instanceof g||i[n]instanceof C){const s=i[n],a=new g(s.value?n:"");s.listen(o=>{a.update(o?n:"")},e),t.push(a)}else t.push(n);return t}function Zt(i,e){const t=new Map,n=new D;return i.listenAndRepeat(s=>{if(s.deleted&&t.has(s.key))n.remove(s.key),t.delete(s.key);else if(t.has(s.key)){const a=s.newValue;a&&!t.get(s.key)&&n.push(s.key),!a&&t.get(s.key)&&n.remove(s.key),t.set(s.key,a)}else if(!t.has(s.key)&&!s.deleted){const a=s.newValue;a&&n.push(s.key),t.set(s.key,a)}},e),n}function Hr(i,...e){if(e=e.filter(o=>!!o),e.length<2)return e[0];let t="";const n=[],s=[];a(e);function a(o){for(const l of o)if(typeof l=="string")t+=l+" ";else if(Array.isArray(l))a(l);else if(l instanceof g||l instanceof C)n.push(l);else if(l instanceof z)s.push(l);else if(typeof l=="object")for(const c in l)l[c]instanceof g||l[c]instanceof C?n.push(l[c].transform(re(h=>h?c:""),i)):t+=l[c]?c+" ":""}if(t=t.trim(),n.length||s.length){let l=function(){const c=[t];for(const h of n)Array.isArray(h.value)?c.push(...h.value):c.push(h.value);for(const h of s)for(const d of h.keys())h.get(d)&&c.push(d);o.update(c.join(" "))};const o=new g;l();for(const c of n)c.listen(l,i);for(const c of s)c.listen(l,i);return o}else return t}function Wr(i,...e){const t=[],n=[];for(const s of e)(typeof s=="string"||typeof s=="boolean")&&t.push(s),(s instanceof g||s instanceof C)&&n.push(s);return n.length?n[0].aggregate(n.slice(1),(...s)=>t.length?s.concat(t).join(" "):s.join(" "),i):t.join(" ")}function qr(i,...e){let t="";const n=[],s=[];for(const a of e)if(typeof a=="string")t+=a+";";else if(a instanceof g||a instanceof C)n.push(a);else if(a instanceof z)s.push(a);else if(typeof a=="object"&&!(a instanceof g||a instanceof C))for(const o in a)a[o]instanceof g?n.push(a[o].transform(l=>`${ve(o)}:${l};`,i)):t+=`${ve(o)}:${a[o]};`;if(n.length||s.length){let a=new g(Ne(t,n,s));for(const o of n)o.listenAndRepeat(l=>{a.update(Ne(t,n,s))},i);for(const o of s)o.listenAndRepeat(l=>{a.update(Ne(t,n,s))},i);return a}else return t}function Ne(i,e,t){let n=i;for(const s of e)n+=s.value;for(const s of t)for(const a of s.keys())s.get(a)&&(n+=`${ve(a)}:${s.get(a)};`);return n}function ve(i){return i.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase()}function yt(i,e){if(typeof i=="string")return i;if(i instanceof g||i instanceof C)return i.transform(ne(),re(t=>Array.isArray(t)?t.join(" "):t),e).withInitial(i.value);if(i instanceof D)return i.reduce((t,n)=>`${t} ${n}`,"",e);if(i instanceof z||typeof i=="object"&&!Array.isArray(i)){const t=Jt(i,e);return yt(t,e)}else{const t=new g(Je(i));for(const n of i)n instanceof g&&n.transform(ne(),e).listen(s=>{t.update(Je(i))},e);return t}}function Je(i){return i.reduce((e,t)=>t==null?e:typeof t=="string"?`${e} ${t}`:t.value?`${e} ${t.value}`:e,"")}function Xt(i,e){if(typeof i=="string")return i;if(i instanceof g||i instanceof C)return i.transform(ne(),re(t=>t.toString()),e);if(i instanceof z)return i.toEntriesArrayDataSource(e).reduce((t,n)=>`${t}${ve(n[0])}:${n[1]};`,"",e);if(typeof i=="object"&&!Array.isArray(i)){const t=new D;let n=0;for(const s in i){if(i[s]instanceof g){const a=n;t.push([s,i[s].value]),i[s].listen(o=>{t.set(a,[s,o])},e)}else t.push([s,i[s]]);n++}return t.reduce((s,a)=>`${s}${ve(a[0])}:${a[1]};`,"",e)}else return""}function Ee(){const i={attachCalls:[],sessionToken:new T(()=>{for(const e of i.tokens)e.cancel()}),tokens:[]};return i}const Be=Symbol("AurumElementModel");function Qt(){const i={attach:new I,detach:new I,onAttach(){i.attach.fire()},onDetach(){i.detach.fire()}};return i}const be=class be{constructor(e,t){w(this,"children");w(this,"api");w(this,"contentStartMarker");w(this,"contentEndMarker");w(this,"hostNode");w(this,"lastStartIndex");w(this,"lastEndIndex");w(this,"disposed",!1);this.children=[],this.api=t,this.api.onAttach(()=>{if(!this.api.cancellationToken.isCancelled){if(this.hostNode===void 0)throw new Error("illegal state: Attach fired but not actually attached");this.render(e)}})}dispose(){this.disposed||(this.hostNode.isConnected&&(this.clearContent(),this.contentStartMarker.remove(),this.contentEndMarker.remove()),this.disposed=!0)}attachToDom(e,t){if(this.hostNode)throw new Error("Aurum Element is already attached");const n=be.id++;this.hostNode=e,this.contentStartMarker=document.createComment("START Aurum Node "+n),this.contentStartMarker.owner=this,this.contentEndMarker=document.createComment("END Aurum Node "+n),t>=e.childNodes.length?(e.appendChild(this.contentStartMarker),e.appendChild(this.contentEndMarker)):(e.insertBefore(this.contentStartMarker,e.childNodes[t]),e.insertBefore(this.contentEndMarker,e.childNodes[t+1]))}getStartIndex(){return this.getWorkIndex()-1}getWorkIndex(){if(this.lastStartIndex!==void 0&&this.hostNode.childNodes[this.lastStartIndex]===this.contentStartMarker)return this.lastStartIndex+1;for(let e=0;e<this.hostNode.childNodes.length;e++)if(this.hostNode.childNodes[e]===this.contentStartMarker)return this.lastStartIndex=e,e+1;return-1}getLastIndex(){if(this.lastEndIndex!==void 0&&this.hostNode.childNodes[this.lastEndIndex]===this.contentEndMarker)return this.lastEndIndex;for(let e=0;e<this.hostNode.childNodes.length;e++)if(this.hostNode.childNodes[e]===this.contentEndMarker)return this.lastEndIndex=e,e;return-1}clearContent(){if(this.hostNode===void 0)throw new Error("illegal state: Aurum element was not attched to anything");let e=this.getWorkIndex();for(;this.hostNode.childNodes[e]!==this.contentEndMarker;)if(!(this.hostNode.childNodes[e]instanceof Comment))this.hostNode.removeChild(this.hostNode.childNodes[e]);else{if(this.hostNode.childNodes[e].owner.disposed)break;this.hostNode.childNodes[e].owner.dispose()}}updateDom(){var s;const e=this.getWorkIndex();let t,n=0;for(t=0;t<this.children.length;t++){const a=this.children[t];if(a==null){n--;continue}if(a!==this.hostNode.childNodes[t+e+n]){if(a instanceof be){if(a.hostNode||a.attachToDom(this.hostNode,t+e+n),a.getStartIndex()===t+e+n)n+=a.getLastIndex()-t-n-e;else{let o=a.getStartIndex(),l=a.getLastIndex();for(let c=o,h=0;c<=l;c++,h++){const d=this.hostNode.childNodes[t+e+n+h],f=this.hostNode.childNodes[c],p=d.parentNode,m=d.nextSibling===f?f:d.nextSibling;f.parentNode.insertBefore(d,f),p.insertBefore(f,m)}n+=a.getLastIndex()-t-n-e}continue}if(this.hostNode.childNodes[t+e+n]!==this.contentEndMarker&&this.hostNode.childNodes[t+e+n]!==this.children[t]&&this.hostNode.childNodes[t+e+n]!==((s=this.children[t+1])==null?void 0:s.contentStartMarker))if(a instanceof HTMLElement||a instanceof Text||a instanceof SVGElement)this.hostNode.removeChild(this.hostNode.childNodes[t+e+n]),this.hostNode.childNodes[t+e+n]?(this.lastEndIndex++,this.hostNode.insertBefore(a,this.hostNode.childNodes[t+e+n])):(this.lastEndIndex++,this.hostNode.appendChild(a));else throw new Error("not implemented");else if(a instanceof HTMLElement||a instanceof Text||a instanceof SVGElement)this.hostNode.childNodes[t+e+n]?(this.lastEndIndex++,this.hostNode.insertBefore(a,this.hostNode.childNodes[t+e+n])):(this.lastEndIndex++,this.hostNode.appendChild(a));else throw new Error("not implemented")}}for(;this.hostNode.childNodes[t+e+n]!==this.contentEndMarker;)this.lastEndIndex--,this.hostNode.removeChild(this.hostNode.childNodes[t+e+n])}};w(be,"id",1);let q=be;function se(i,e,t=!1){if(i!=null){if(Array.isArray(i)){const n=[];for(const s of i){const a=se(s,e,t);a!=null&&(Array.isArray(a)?n.push(...a):n.push(a))}return n}if(!t){const n=typeof i;if(n==="string")return document.createTextNode(i);if(n==="number"||n==="bigint"||n==="boolean")return document.createTextNode(i.toString());if(i instanceof Promise){const s=new g;return i.then(o=>{s.update(o)}),new Ge(s,ye(e))}else{if(i instanceof g||i instanceof C)return new Ge(i,ye(e));if(i instanceof D)return new gt(i,ye(e))}}if(i[Be]){const n=i;let s;!n.isIntrinsic||n.props?s=ye(e):s={renderSession:e};let a;return n.isIntrinsic?a=n.factory(n.props,n.children,s):a=n.factory(n.props??{},n.children,s),se(a,e,t)}return i}}function ye(i){let e;const t={renderSession:i,synchronizeLifeCycle(n){t.onAttach(()=>n.onAttach()),t.onDetach(()=>n.onDetach())},onAttach:n=>{i.attachCalls.push(n)},onDetach:n=>{e||(e=new T,i.tokens.push(e)),e.addCancellable(n)},get cancellationToken(){return e||(e=new T,i.tokens.push(e)),e},prerender(n,s){const a=s,o=Ee(),l=se(n,o,!0);return a.attach.subscribeOnce(()=>{o.attachCalls.forEach(c=>c())}),a.detach.subscribeOnce(()=>{a.attach.cancelAll(),o.sessionToken.cancel()}),l}};return t}class gt extends q{constructor(t,n){super(t,n);w(this,"renderSessions");w(this,"dataSource");this.renderSessions=new WeakMap,this.dataSource=t}dispose(){this.disposed||(this.api.cancellationToken.cancel(),super.dispose())}attachToDom(t,n){super.attachToDom(t,n),this.contentStartMarker.dataSource=this.dataSource,this.contentEndMarker.dataSource=this.dataSource}render(t){t.listenAndRepeat(n=>{this.disposed||this.handleNewContent(n)},this.api.cancellationToken)}spliceChildren(t,n,...s){var o;let a;s?a=this.children.splice(t,n,...s):a=this.children.splice(t,n);for(const l of a)(o=this.renderSessions.get(l))==null||o.sessionToken.cancel()}handleNewContent(t){if(this.hostNode===void 0)throw new Error("illegal state: Aurum element was not attched to anything");let n=!1;const s=[];switch(t.operationDetailed){case"merge":const a=t.previousState.slice();for(let f=0;f<t.newState.length;f++)if(this.children.length<=f){const p=this.renderItem(t.newState[f],s);Array.isArray(p)?this.children.push(...p):this.children.push(p),a.push(t.newState[f])}else if(a[f]!==t.newState[f]){const p=a.indexOf(t.newState[f],f);if(p!==-1){const m=this.children[f],v=this.children[p];this.children[f]=v,this.children[p]=m;const b=a[f],A=a[p];a[f]=A,a[p]=b}else{const m=this.renderItem(t.newState[f],s);Array.isArray(m)?this.spliceChildren(f,0,...m):this.spliceChildren(f,0,m),a.splice(f,0,t.newState[f])}}this.children.length>t.newState.length&&this.spliceChildren(t.newState.length,this.children.length-t.newState.length);break;case"remove":case"removeLeft":case"removeRight":this.spliceChildren(Ue(t.newState,t.index),Ue(t.items,t.items.length));break;case"append":let o=this.getLastIndex();n=!0;for(const f of t.items){const p=this.renderItem(f,s);if(Array.isArray(p)){this.children=this.children.concat(p);for(let m=0;m<=p.length;m++)p[m]&&(p[m]instanceof q?(p[m].attachToDom(this.hostNode,o),this.lastEndIndex=this.getLastIndex(),o=this.lastEndIndex):(this.hostNode.insertBefore(p[m],this.hostNode.childNodes[o]),this.lastEndIndex++,o++))}else this.children.push(p),p&&(p instanceof q?(p.attachToDom(this.hostNode,o),this.lastEndIndex=this.getLastIndex(),o=this.lastEndIndex):(this.hostNode.insertBefore(p,this.hostNode.childNodes[o]),this.lastEndIndex++,o++))}break;case"replace":const l=this.renderItem(t.items[0],s);if(Array.isArray(l))throw new Error("illegal state");this.children[t.index]=l;break;case"swap":const c=this.children[t.index],h=this.children[t.index2];if(c instanceof HTMLElement&&h instanceof HTMLElement||c instanceof SVGElement&&h instanceof SVGElement){if(n=!0,c.parentElement===h.parentElement){if(c.nextSibling===h){h.parentNode.insertBefore(h,c),this.children[t.index2]=c,this.children[t.index]=h;break}if(h.nextSibling===c){h.parentNode.insertBefore(c,h),this.children[t.index2]=c,this.children[t.index]=h;break}}const f=c.parentNode,p=c.nextSibling===h?h:c.nextSibling;h.parentNode.insertBefore(c,h),f.insertBefore(h,p)}this.children[t.index2]=c,this.children[t.index]=h;break;case"prepend":for(let f=t.items.length-1;f>=0;f--){const p=t.items[f],m=this.renderItem(p,s);if(Array.isArray(m))throw new Error("illegal state");this.children.unshift(m)}break;case"insert":let d=t.index;for(const f of t.items){const p=this.renderItem(f,s);if(Array.isArray(p))throw new Error("illegal state");this.children.splice(d,0,p),d+=1}break;case"clear":this.spliceChildren(0,this.children.length),this.renderSessions=new WeakMap;break;default:throw new Error(`DOM updates from ${t.operationDetailed} are not supported`)}n||this.updateDom();for(const a of s)a()}renderItem(t,n){if(t==null)return;const s=Ee(),a=se(t,s);if(a!=null)return a instanceof q&&s.sessionToken.addCancellable(()=>a.dispose()),this.renderSessions.set(a,s),n.push(...s.attachCalls),a}}function Ue(i,e){let t=0;for(let n=0;n<e;n++)Array.isArray(i[n])?t+=Ue(i[n],i[n].length):t++;return t}class Ge extends q{constructor(t,n){super(t,n);w(this,"renderSession");w(this,"lastValue");w(this,"dataSource");this.api.cancellationToken.addCancellable(()=>{var s;return(s=this.renderSession)==null?void 0:s.sessionToken.cancel()}),this.dataSource=t}dispose(){this.disposed||(this.api.cancellationToken.cancel(),super.dispose())}attachToDom(t,n){super.attachToDom(t,n),this.contentStartMarker.dataSource=this.dataSource,this.contentEndMarker.dataSource=this.dataSource}render(t){t.listenAndRepeat(n=>{this.disposed||this.handleNewContent(n)},this.api.cancellationToken)}handleNewContent(t){if(this.lastValue===t)return;let n=!1;if(this.children.length===1&&this.children[0]instanceof Text){const s=typeof t;(s==="string"||s==="bigint"||s==="number"||s==="boolean")&&(this.children[0].nodeValue=t,n=!0)}if(!n){this.fullRebuild(t),this.updateDom();for(const s of this.renderSession.attachCalls)s()}this.lastValue=t}fullRebuild(t){this.clearContent(),this.endSession(),this.renderSession=Ee();let n=se(t,this.renderSession);if(n===void 0){this.children=[];return}Array.isArray(n)||(n=[n]);for(const s of n)s instanceof q&&this.renderSession.sessionToken.addCancellable(()=>{s.dispose()});Array.isArray(n)&&(this.children=n)}endSession(){this.renderSession&&(this.renderSession.sessionToken.cancel(),this.renderSession=void 0)}}const en={drag:"onDrag",dragstart:"onDragStart",dragend:"onDragEnd",dragexit:"onDragExit",dragover:"onDragOver",dragenter:"onDragEnter",dragleave:"onDragLeave",drop:"onDrop",blur:"onBlur",focus:"onFocus",click:"onClick",dblclick:"onDblClick",keydown:"onKeyDown",keyhit:"onKeyHit",keyup:"onKeyUp",contextmenu:"onContextMenu",mousedown:"onMouseDown",mouseup:"onMouseUp",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",load:"onLoad",error:"onError"},tn=["id","name","draggable","tabindex","role","contenteditable","slot","title"];function y(i,e,t,n,s=!1){return function(a,o,l){let c;s?c=document.createElementNS("http://www.w3.org/2000/svg",i):c=document.createElement(i),a&&sn(c,a,l.cancellationToken,e,t);const h=se(o,l.renderSession);return nn(c,h),a&&(a.onAttach&&l.onAttach(()=>a.onAttach(c)),a.onDetach&&l.onDetach(()=>{c.isConnected&&c.parentElement.removeChild(c),a.onDetach(c)})),n==null||n(c,a,l.cancellationToken),c}}function nn(i,e){if(!(e==null||e.length===0)){for(const t of e)if(t)if(t instanceof Text||t instanceof HTMLElement||t instanceof SVGElement)i.appendChild(t);else if(t instanceof q)t.attachToDom(i,i.childNodes.length);else throw typeof t=="function"?new Error("Unexpected child type passed to DOM Node: function. Did you mean to use a component? To use a component use JSX syntax such as <MyComponent/> it works even with function references. <props.myReference/>"):new Error(`Unexpected child type passed to DOM Node: ${e}`)}}function sn(i,e,t,n,s){Ze(i,en,e),s&&Ze(i,s,e);const a=Object.keys(e).filter(o=>o.includes("-"));if(Xe(i,tn,e,t,a),n&&Xe(i,n,e,t),e.style){const o=Xt(e.style,t);o instanceof g?o.listenAndRepeat(l=>{i.setAttribute("style",l)},t):i.setAttribute("style",o)}if(e.class){const o=yt(e.class,t);o instanceof g?o.listenAndRepeat(l=>{i.className=l},t):i.className=o}}function Ze(i,e,t){for(const n in e)t[e[n]]&&(t[e[n]]instanceof g?i.addEventListener(n,s=>t[e[n]].update(s)):t[e[n]]instanceof C?i.addEventListener(n,s=>t[e[n]].updateDownstream(s)):typeof t[e[n]]=="function"&&i.addEventListener(n,s=>t[e[n]](s)))}function Xe(i,e,t,n,s){for(const a of e)t[a]&&Qe(i,t[a],a,n);if(s)for(const a of s)t[a]&&Qe(i,t[a],a,n)}function Yr(i,e){const t=Ee(),n=se(i,t);return e&&(e.onAttach(()=>t.attachCalls.forEach(s=>s())),e.onDetach(()=>t.sessionToken.cancel())),{content:n,fireOnAttach:()=>t.attachCalls.forEach(s=>s()),dispose:()=>t.sessionToken.cancel()}}function Qe(i,e,t,n){if(typeof e=="string")i.setAttribute(t,e);else if(typeof e=="boolean")e&&i.setAttribute(t,"");else if(e instanceof g||e instanceof C)typeof e.value=="string"?i.setAttribute(t,e.value):typeof e.value=="boolean"&&e.value&&i.setAttribute(t,""),e.transform(ne(),n).listen(s=>{typeof s=="string"?i.setAttribute(t,s):typeof s=="boolean"&&(s?i.setAttribute(t,""):i.removeAttribute(t))});else throw new Error("Attributes only support types boolean, string, number and data sources")}const rn={input:"onInput",change:"onChange"},an=["placeholder","readonly","disabled","accept","alt","autocomplete","autofocus","checked","defaultChecked","formAction","formEnctype","formMethod","formNoValidate","formTarget","max","maxLength","min","minLength","pattern","multiple","required","type","step","list"],on=y("input",an,rn,(i,e,t)=>{const n=i;e.value&&(e.value instanceof g?(e.value.listenAndRepeat(s=>{n.value=s??""},t),n.addEventListener("input",()=>{e.value.update(n.value)})):e.value instanceof C?(e.value.listenAndRepeat(s=>{n.value=s??""},t),n.addEventListener("input",()=>{e.value.updateUpstream(n.value)})):n.value=e.value),e.checked&&(e.checked instanceof g?(e.checked.listenAndRepeat(s=>{n.checked=s??!1},t),n.addEventListener("change",()=>{e.checked.update(n.checked)})):e.checked instanceof C?(e.checked.listenAndRepeat(s=>{n.checked=s??!1},t),n.addEventListener("change",()=>{e.checked.updateUpstream(n.checked)})):n.checked=e.checked)}),ln={change:"onChange"},cn=y("select",void 0,ln,(i,e,t)=>{const n=i;if(e!=null&&e.value||e!=null&&e.selectedIndex){if(e.value instanceof g||e.value instanceof C){const s=new MutationObserver(()=>{n.value=e.value.value});s.observe(n,{childList:!0}),t.addCancellable(()=>{s.disconnect()})}if(e.selectedIndex instanceof g||e.selectedIndex instanceof C){const s=new MutationObserver(()=>{n.selectedIndex=e.selectedIndex.value});s.observe(n,{childList:!0}),t.addCancellable(()=>{s.disconnect()})}e.value instanceof g?(e.value.listenAndRepeat(s=>{n.value=s},t),n.addEventListener("change",()=>{e.value.update(n.value)})):e.value instanceof C?(e.value.listenAndRepeat(s=>{n.value=s},t),n.addEventListener("change",()=>{e.value.updateUpstream(n.value)})):n.value=e.value,e!=null&&e.selectedIndex&&(e.selectedIndex instanceof g?(e.selectedIndex.listenAndRepeat(s=>{n.selectedIndex=s},t),n.addEventListener("change",()=>{e.selectedIndex.update(n.selectedIndex)})):e.selectedIndex instanceof C?(e.selectedIndex.listenAndRepeat(s=>{n.selectedIndex=s},t),n.addEventListener("change",()=>{e.selectedIndex.updateUpstream(n.selectedIndex)})):n.selectedIndex=e.selectedIndex)}}),un=y("code"),dn=y("div"),hn=y("a",["href","target","hreflang","media","download","ping","referrerpolicy","rel","type"]),fn=y("abbr"),pn=y("address"),mn=y("h1"),yn=y("h2"),gn=y("h3"),wn=y("h4"),bn=y("h5"),An=y("h6"),kn=y("area",["alt","coors","download","href","hreflang","media","rel","shape","target","type","ping","referrerpolicy"]),vn=y("article"),En=y("aside"),Sn=y("span"),xn=y("noscript"),Dn=y("video",["controls","autoplay","loop","muted","preload","src","poster","width","height","autopictureinpicture","controlslist","crossorigin","disablepictureinpicture","disableremoteplayback","playsinline"],{canPlay:"onCanPlay",canplaythrough:"onCanPlayThrough",complete:"onComplete",durationchange:"onDurationChange",emptied:"onEmptied",ended:"onEnded",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",pause:"onPause",play:"onPlay",playing:"onPlaying",progress:"onProgress",ratechange:"onRateChange",seeked:"onSeeked",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",volumechange:"onVolumeChange",waiting:"onWaiting"}),Tn=y("ul"),Cn=y("ol"),Rn=y("li"),_n=y("b"),On=y("body"),In=y("title"),Ln=y("summary"),Nn=y("thead"),Mn=y("template"),Un=y("q"),Pn=y("pre"),$n=y("p"),Fn=y("hr"),zn=y("audio",["controls","autoplay","loop","muted","preload","src","crossorigin"],{audioprocess:"onAudioProcess",canplay:"onCanPlay",canplaythrough:"onCanPlayThrough",complete:"onComplete",durationchange:"onDurationChange",emptied:"onEmptied",ended:"onEnded",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",pause:"onPause",play:"onPlay",playing:"onPlaying",ratechange:"onRateChange",seeked:"onSeeked",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",volumechange:"onVolumeChange",waiting:"onWaiting"}),jn=y("br"),Bn=y("button",["disabled","autofocus","form","formaction","formenctype","formmethod","formnovalidate","formtarget","type"]),Kn=y("canvas",["width","height"]),Hn=y("data",["value"]),Wn=y("details"),qn=y("em"),Yn=y("footer"),Vn=y("form",["action","method","rel","enctype","novalidate","target","accept-charset","autocomplete"]),Jn=y("meta",["http-equiv","charset","content"]),Gn=y("html",["lang","xmlns"]),Zn=y("head"),Xn=y("header"),Qn=y("heading"),es=y("i"),ts=y("iframe",["src","srcdoc","width","height","allow","allowfullscreen","allowpaymentrequest","loading","sandbox","frameborder","csp","referrerpolicy"]),ns=y("img",["src","alt","width","height","referrerpolicy","sizes","srcset","usemap","crossorigin","decoding","ismap","loading"]),ss=y("label",["for"]),is=y("link",["href","rel","media","as","disabled","type","crossorigin","hreflang","referrerpolicy","sizes","integrity","imagesizes","prefetch"]),rs=y("nav"),as=y("sub"),os=y("sup"),ls=y("table"),cs=y("tbody"),us=y("tfoot"),ds=y("col",["span"]),hs=y("colgroup",["span"]),fs=y("caption"),ps=y("tr"),ms=y("td",["colspan","headers","rowspan"]),ys=y("th",["scope","abbr","colspan","headers","rowspan"]),gs=y("time",["datetime"]),ws=y("style",["media","type","nonce"]),bs=y("source",["src","srcset","media","sizes","type"]),As=y("track",["src","srclang","label","kind","default"]),ks=y("param",["value"]),vs=y("script",["src","async","defer","integrity","nomodule","type","crossorigin","referrerpolicy","text","nonce"]),N=["clip-path","clip-rule","color","color-interpolation","color-rendering","cursor","display","fill","fill-opacity","fill-rule","filter","mask","opacity","pointer-events","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","transform","vector-effect","visibility"],Es=y("svg",["width","height","xmlns","version","x","y","x1","y1","x2","y2","cx","cy","r","rx","ry","d","path","points","viewBox","preserveAspectRatio","xmlns:xlink","xml:space",...N],void 0,void 0,!0),Ss=y("circle",["cx","cy","r",...N],void 0,void 0,!0),xs=y("ellipse",["cx","cy","rx","ry",...N],void 0,void 0,!0),Ds=y("line",["x1","y1","x2","y2",...N],void 0,void 0,!0),Ts=y("polygon",["points",...N],void 0,void 0,!0),Cs=y("polyline",["points",...N],void 0,void 0,!0),Rs=y("path",["d",...N],void 0,void 0,!0),_s=y("rect",["x","y","width","height",...N],void 0,void 0,!0),Os=y("text",["dx","dy","rotate","textLength","x","y",...N],void 0,void 0,!0),Is=y("tspan",["dx","dy","rotate","textLength","x","y",...N],void 0,void 0,!0),Ls=y("image",["x","y","width","height","href",...N],void 0,void 0,!0),Ns=y("g",[...N],void 0,void 0,!0),Ms=y("defs",[...N],void 0,void 0,!0),Us=y("symbol",["viewBox","preserveAspectRatio",...N],void 0,void 0,!0),Ps=y("use",["href","x","y","width","height",...N],void 0,void 0,!0),$s=y("marker",["viewBox","preserveAspectRatio","refX","refY","markerWidth","markerHeight","orient",...N],void 0,void 0,!0),Fs=y("mask",["x","y","width","height",...N],void 0,void 0,!0),zs=y("linearGradient",["x1","y1","x2","y2",...N],void 0,void 0,!0),js=y("radialGradient",["cx","cy","r","fx","fy","fr",...N],void 0,void 0,!0),Bs=y("stop",["offset","stop-color","stop-opacity",...N],void 0,void 0,!0),Ks=y("clipPath",["clipPathUnits",...N],void 0,void 0,!0),Hs=y("foreignObject",["x","y","width","height",...N],void 0,void 0,!0),Ws=y("pattern",["x","y","width","height","patternUnits","patternContentUnits","patternTransform","viewBox","preserveAspectRatio",...N],void 0,void 0,!0),qs=y("progress",["max","value"]),Ys=y("option",["value","label","disabled","selected"]),Vs=y("optgroup",["label","disabled"]),Js=y("slot"),Gs=y("strong"),Zs=y("samp"),Xs=y("kbd"),Qs=y("var"),ei=y("wbr"),ti=y("picture"),ni=y("output",["for","form"]),si=y("object",["data","width","height","form","type","usemap"]),ii={input:"onInput",change:"onChange"},ri=["placeholder","readonly","disabled","form","cols","rows","wrap","autocomplete","autofocus","max","maxLength","min","spellcheck","minLength","required","type"],ai=y("textArea",ri,ii,(i,e,t)=>{const n=i;e.value&&(e.value instanceof g?(e.value.listenAndRepeat(s=>{n.value=s},t),n.addEventListener("input",()=>{e.value.update(n.value)})):e.value instanceof C?(e.value.listenAndRepeat(s=>{n.value=s},t),n.addEventListener("input",()=>{e.value.updateUpstream(n.value)})):n.value=e.value)}),oi={address:pn,kbd:Xs,samp:Zs,object:si,optgroup:Vs,picture:ti,output:ni,param:ks,strong:Gs,track:As,var:Qs,wbr:ei,button:Bn,code:un,hr:Fn,div:dn,input:on,li:Rn,span:Sn,style:ws,ul:Tn,p:$n,img:ns,link:is,canvas:Kn,a:hn,article:vn,br:jn,form:Vn,label:ss,ol:Cn,pre:Pn,progress:qs,table:ls,td:ms,tr:ps,th:ys,textarea:ai,h1:mn,h2:yn,h3:gn,h4:wn,h5:bn,h6:An,html:Gn,head:Zn,header:Xn,footer:Yn,nav:rs,b:_n,i:es,script:vs,abbr:fn,area:kn,aside:En,audio:zn,em:qn,heading:Qn,iframe:ts,noscript:xn,option:Ys,q:Un,select:cn,source:bs,title:In,video:Dn,tbody:cs,tfoot:us,meta:Jn,body:On,thead:Nn,summary:Ln,details:Wn,sub:as,sup:os,svg:Es,data:Hn,time:gs,template:Mn,slot:Js,col:ds,colgroup:hs,caption:fs,line:Ds,rect:_s,defs:Ms,g:Ns,text:Os,tspan:Is,circle:Ss,ellipse:xs,polygon:Ts,polyline:Cs,path:Rs,image:Ls,symbol:Us,use:Ps,stop:Bs,lineargradient:zs,radialgradient:js,clippath:Ks,pattern:Ws,mask:Fs,foreignobject:Hs,marker:$s};class u{static rehydrate(e,t){const n=t.parentElement;return t.remove(),u.attach(e,n)}static attach(e,t){const n=Ee(),s=se(e,n);if(s instanceof q)s.attachToDom(t,t.childNodes.length),n.sessionToken.addCancellable(()=>s.dispose());else if(Array.isArray(s)){const a=new gt(new D(s),ye(n));n.sessionToken.addCancellable(()=>a.dispose()),a.attachToDom(t,t.childNodes.length)}else t.appendChild(s),n.sessionToken.addCancellable(()=>{s.isConnected&&t.removeChild(s)});for(let a=n.attachCalls.length-1;a>=0;a--)n.attachCalls[a]();return n.sessionToken}static fragment(){}static factory(e,t,...n){if(e===u.fragment)return n;let s,a=!1;if(typeof e=="string"){a=!0,s=e;const l=e;if(e=oi[e],e===void 0)throw new Error(`Node ${l} does not exist or is not supported`)}else s=e.name;let o={[Be]:!0,name:s,isIntrinsic:a,factory:e,props:t,children:n};if(t!=null&&t.decorate!=null)if(Array.isArray(t.decorate))for(const l of t.decorate)o=l(o);else if(typeof t.decorate=="function")o=t.decorate(o);else throw new Error("Decorate must be a function or an array of functions");return o}}function Vr(i,e,t,n){(n??new T).setInterval(()=>{Pe(i,t)},e)}function Pe(i,e){i instanceof D?i.push(e):i instanceof C?i.updateDownstream(e):i.update(e)}function li(i,e=!1,t){Pe(i,e?et():location.hash),(t??new T).registerDomEvent(window,"hashchange",()=>{Pe(i,e?et():location.hash)})}function et(){const i=location.hash.substring(1);return i.includes("?")?i.substring(0,i.indexOf("?")):i.includes("#")?i.substring(0,i.indexOf("#")):i}function Jr(i,e=100,t){t??(t=new T);const n=new g;t.registerDomEvent(window,"resize",()=>{n.update()}),i.assign({width:window.innerWidth,height:window.innerHeight}),n.transform(ke(e),je(()=>i.assign({width:window.innerWidth,height:window.innerHeight})))}function ci(i,e,t){return new Promise(n=>{const s=new T;t&&t.chain(s),s.addCancellable(n);let a=Date.now();ut(()=>{const o=Math.min(1,(Date.now()-a)/e);i(o),o===1&&s.cancel()},s)})}function Gr(i,e,t,n,s,a){return(i instanceof g||i instanceof C||i instanceof F)&&t===n?new Promise(o=>setTimeout(o,e)):ci(o=>{s&&(o=s(o));const l=t+(n-t)*o;i instanceof D?i.push(l):i instanceof C?i.updateDownstream(l):i.update(l)},e,a)}function ui(i,e,t){const n=wt(i),s=D.fromMultipleSources(n,e);return t&&s.listen(a=>{switch(a.operation){case"add":case"replace":case"merge":for(const o of a.items)t(o);break}},e),s}function wt(i){const e=[];let t=[];for(const n of i)n instanceof D?(t.length&&(e.push(t),t.length=0),e.push(n)):n instanceof g||n instanceof g||n instanceof g?t.push(n):Array.isArray(n)?e.push(...wt(n)):t.push(n);return t.length&&e.push(t),e}function De(i,e,t){const n=ui(e,t.cancellationToken,o=>{if(o.factory!==L&&o.factory!==te)throw new Error("Aurum Router only accepts Route and DefaultRoute instances as children")}).filter(Boolean);n.reduce((o,l)=>l.factory===te?o+1:o,0,t.cancellationToken).listenAndRepeat(o=>{if(o>1)throw new Error(`Too many default routes only 0 or 1 allowed. Found ${o}`)});const s=new g;typeof window<"u"&&li(s,!0,t.cancellationToken);const a=new g;return a.transform(ne(),pt(),je(({newValue:o,oldValue:l})=>{var c,h,d,f;l&&((h=(c=l.props)==null?void 0:c.onNavigateFrom)==null||h.call(c)),o&&((f=(d=o.props)==null?void 0:d.onNavigateTo)==null||f.call(d))})),s.transform(ne(),t.cancellationToken).withInitial(s.value).transform(re(o=>di(o,n,a)))}function di(i,e,t){let n;if(i==null)n=e.find(s=>s.factory===te);else if(e.find(s=>{var a;return((a=s.props)==null?void 0:a.href)===i}))n=e.find(s=>{var a;return((a=s.props)==null?void 0:a.href)===i});else{const s=i.split("/");for(s.pop();s.length;){const a=s.join("/");if(e.find(o=>{var l;return((l=o.props)==null?void 0:l.href)===a})){n=e.find(o=>{var l;return((l=o.props)==null?void 0:l.href)===a});break}s.pop()}n||(n=e.find(a=>a.factory===te))}if(n)return t.update(n),n.children;t.update(void 0)}function L(i,e){}function te(i,e){}function hi(i,e,t){const n=new g(i==null?void 0:i.suspenseFallback),s=typeof(i==null?void 0:i.errorFallback)=="function"?i.errorFallback:d=>i==null?void 0:i.errorFallback,a=Qt();t.onDetach(()=>a.onDetach());function o(d){t.cancellationToken.isCancelled||(n.update(d),a.onAttach())}function l(d){console.error(d),t.cancellationToken.isCancelled||n.update(s(d))}async function c(d){if(d instanceof Promise)d.then(c,l);else{const f=t.prerender(d,a);f.some(p=>p instanceof Promise)?await Promise.all(f).then(c,l):o(f)}}async function h(){try{const d=t.prerender(e,a);await c(d)}catch(d){l(d)}}return h(),n}function fi(i,e,t){return u.factory(hi,{suspenseFallback:i==null?void 0:i.fallback,errorFallback:n=>{throw n}},e)}function pi(i,e,t){if(e=[].concat.apply([],e.filter(a=>!!a)),e.some(a=>!a[Be]||!(a.factory===bt||a.factory===_e)))throw new Error("Switch only accepts SwitchCase as children");if(e.filter(a=>a.factory===_e).length>1)throw new Error("Too many default switch cases only 0 or 1 allowed");const n=new T;return t.onDetach(()=>{n.cancel()}),i.state.transform(ne(),n).withInitial(i.state.value).transform(re(a=>mi(a,e)))}function mi(i,e){var t,n;return((t=e.find(s=>{var a;return((a=s.props)==null?void 0:a.when)===i}))==null?void 0:t.children)??((n=e.find(s=>s.factory===_e))==null?void 0:n.children)}function bt(i,e){}function _e(i,e){}class yi{constructor(){w(this,"state");w(this,"originalReplaceState");w(this,"updating",!1);this.state={},this.observeUrl(),window.addEventListener("hashchange",()=>this.checkUpdate()),this.checkUpdate()}observeUrl(){this.originalReplaceState=history.replaceState.bind(history),history.replaceState=(...e)=>{this.originalReplaceState.apply(history,e),this.checkUpdate()}}get length(){return Object.keys(this.state).length}clear(){this.state={},this.applyStateToUrl()}getItem(e){return this.state[e]}key(e){return Object.keys(this.state)[e]}removeItem(e){delete this.state[e],this.updating||this.applyStateToUrl()}setItem(e,t){this.state[e]=t,this.updating||this.applyStateToUrl()}applyStateToUrl(){const e=new URL(location.href);for(const t of e.searchParams.entries())e.searchParams.delete(t[0]);for(const t in this.state)e.searchParams.set(t,this.state[t]);this.originalReplaceState({},"",e.href)}refresh(){this.checkUpdate()}checkUpdate(){const e=Object.fromEntries(new URL(location.href).searchParams);this.updating=!0;try{for(const t in e)e[t]!==this.state[t]&&this.setItem(t,e[t]);for(const t in this.state)e[t]===void 0&&this.removeItem(t)}finally{this.updating=!1}}}class Ke{constructor(e){w(this,"storageAPI");w(this,"onChange");w(this,"originalSetItem");w(this,"originalRemoveItem");this.onChange=new I,this.storageAPI=e,this.observeStorageAPI(e)}observeStorageAPI(e){this.originalSetItem=e.setItem.bind(e),e.setItem=(n,s)=>{this.originalSetItem(n,s),this.onChange.fire({key:n,value:s})},this.originalRemoveItem=e.removeItem.bind(e),e.removeItem=n=>{this.originalRemoveItem(n),this.onChange.fire({key:n,value:void 0})};const t=e.clear.bind(e);e.clear=()=>{t(),this.onChange.fire({key:"*",value:void 0})}}listenAsString(e,t,n){const s=new C().withInitial(this.storageAPI.getItem(e)??t);return this.onChange.subscribe(a=>{(a.key===e||a.key==="*")&&s.updateDownstream(a.value??t)},n),s.listenUpstream(a=>{a===void 0||a===t?this.originalRemoveItem(e):this.originalSetItem(e,a)},n),s}listenAsNumber(e,t,n,s=10){const a=new C().withInitial(this.storageAPI.getItem(e)?parseInt(this.storageAPI.getItem(e),s):t);return this.onChange.subscribe(o=>{(o.key===e||o.key==="*")&&a.updateDownstream(o.value!=null?parseInt(o.value,s):t)},n),a.listenUpstream(o=>{o===void 0||o===t?this.originalRemoveItem(e):this.originalSetItem(e,o.toString())},n),a}listenAsDate(e,t,n){const s=new C().withInitial(this.storageAPI.getItem(e)?new Date(this.storageAPI.getItem(e)):t);return this.onChange.subscribe(a=>{(a.key===e||a.key==="*")&&s.updateDownstream(a.value!=null?new Date(a.value):t)},n),s.listenUpstream(a=>{a===void 0||a===t?this.originalRemoveItem(e):this.originalSetItem(e,a.toJSON())},n),s}listenAsBoolean(e,t,n){const s=new C().withInitial(this.storageAPI.getItem(e)?this.storageAPI.getItem(e)==="true":t);return this.onChange.subscribe(a=>{(a.key===e||a.key==="*")&&s.updateDownstream(a.value!=null?a.value==="true":t)},n),s.listenUpstream(a=>{a===void 0||a===t?this.originalRemoveItem(e):this.originalSetItem(e,a.toString())},n),s}listenAsObject(e,t,n){const s=new C().withInitial(this.storageAPI.getItem(e)?JSON.parse(this.storageAPI.getItem(e)):typeof t=="function"?t():t);return this.onChange.subscribe(a=>{(a.key===e||a.key==="*")&&s.updateDownstream(a.value!=null?JSON.parse(a.value):typeof t=="function"?t():t)},n),s.listenUpstream(a=>{a===void 0?this.originalRemoveItem(e):this.originalSetItem(e,JSON.stringify(a))},n),s}listenAsEnum(e,t,n){const s=new C().withInitial(this.storageAPI.getItem(e)??t);return this.onChange.subscribe(a=>{(a.key===e||a.key==="*")&&s.updateDownstream(a.value!=null?a.value:t)},n),s.listenUpstream(a=>{a===void 0||a===t?this.originalRemoveItem(e):this.originalSetItem(e,a.toString())},n),s}listenAsArray(e,t){const n=new D(JSON.parse(this.storageAPI.getItem(e)??"[]"));return this.onChange.subscribe(s=>{(s.key===e||s.key==="*")&&n.merge(s.value!=null?JSON.parse(s.value):[])},t),n.listen(s=>{this.originalSetItem(e,JSON.stringify(s.newState))},t),n}listenAsSet(e,t){const n=new B(JSON.parse(this.storageAPI.getItem(e)??"[]"));return this.onChange.subscribe(s=>{(s.key===e||s.key==="*")&&n.merge(s.value!=null?JSON.parse(s.value):[])},t),n.listen(s=>{this.originalSetItem(e,JSON.stringify(n.toArray()))},t),n}}let gi;typeof localStorage<"u"&&(gi=new Ke(localStorage));let wi;typeof sessionStorage<"u"&&(wi=new Ke(sessionStorage));let bi;typeof location<"u"&&(bi=new Ke(new yi));function Ai(){return u.factory("div",{class:"container"},u.factory("div",{class:"section"},u.factory("div",{class:"row"},u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"flash_on")),u.factory("h5",{class:"center"},"Lightning fast"),u.factory("p",{class:"light"},"Faster than react, faster than angular, Aurum.js does not waste time deciding what needs to render. The library has been designed in a way that figuring out what needs to be rendered is almost free, giving you massive performance without without sacrifycing power. Not convinced? See how blazingly fast you can navigate around this very website!"))),u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"query_builder")),u.factory("h5",{class:"center"},"Small learning curve"),u.factory("p",{class:"light"},"Aurum.js has very few concepts and a small API, you can get a full understanding of Aurum.js in record time."))),u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"settings")),u.factory("h5",{class:"center"},"Write less do more"),u.factory("p",{class:"light"},"Aurum.js is very concise, you declare in one go how your view looks like and how it interacts with your data. No complicated data management needed."))))),u.factory("br",null))}const ki="modulepreload",vi=function(i){return"/aurum-website/"+i},tt={},nt=function(e,t,n){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(a=>{if(a=vi(a),a in tt)return;tt[a]=!0;const o=a.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===a&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${l}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":ki,o||(h.as="script",h.crossOrigin=""),h.href=a,document.head.appendChild(h),o)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a})},At=[{title:"Hello world",description:"Basic Hello world example",code:new g(`return function() {
	return <div>Hello world</div>
}`)},{title:"Rendering lists",description:"List of items synchronized to the data",code:new g(`import { ArrayDataSource } from 'aurumjs'
const items = new ArrayDataSource(['item one', 'item two'])

return function() {
	return <div>{items.map(i => <p>{i}</p>)}
	<button onClick={() => items.push('More')}>Add more</button>
	</div>
}`)},{title:"Simple timer",description:"Updates every second to show how many seconds passed since the execution began",code:new g(`import { DataSource } from 'aurumjs'

return function() {
const seconds = new DataSource(0);

	setInterval(() => {
		seconds.update(seconds.value+1);
	},1000)

	return <div>{seconds}</div>
}`)},{title:"Conditional rendering",description:"Using data sources to render different branches conditionally",code:new g(`import { DataSource } from 'aurumjs'

return function() {
const tabContent = new DataSource(<span>hello Tab 1</span>);

	return (<div>
		<button onClick={() => tabContent.update(<span>hello Tab 1</span>)}>Tab 1</button>
		<button onClick={() => tabContent.update(<span>hello Tab 2</span>)}>Tab 2</button>
		<button onClick={() => tabContent.update(<span>hello Tab 3</span>)}>Tab 3</button>
		{tabContent}
		</div>)
}`)},{title:"Asynchronous Components",description:"Aurum supports rendering async content. It will simply wait for the promise to resolve and render the resolved value. You can use the Suspense component to render temporary content while waiting for a promise.",code:new g(`import { DataSource, Suspense } from 'aurumjs'

function sleep(time) {
	return new Promise((resolve) => {
		setTimeout(resolve,time);
	})
}

async function AsyncComponent({delay}){
	await sleep(delay);
	return <div>I'm ready</div>
}

return function() {
	const content = new DataSource([
		<AsyncComponent delay={1000}></AsyncComponent>,
		<AsyncComponent delay={2000}></AsyncComponent>,
		<AsyncComponent delay={3000}></AsyncComponent>,
		<AsyncComponent delay={4000}></AsyncComponent>,
		<AsyncComponent delay={5000}></AsyncComponent>,
		<Suspense fallback={<div>Waiting...</div>}> <AsyncComponent delay={6000}></AsyncComponent> </Suspense>
	]);

	return (<div>
		{content}
		<button onClick={() => content.update([
			<AsyncComponent delay={1000}></AsyncComponent>,
			<AsyncComponent delay={2000}></AsyncComponent>,
			<AsyncComponent delay={3000}></AsyncComponent>,
			<AsyncComponent delay={4000}></AsyncComponent>,
			<AsyncComponent delay={5000}></AsyncComponent>,
			<Suspense fallback={<div>Waiting...</div>}> <AsyncComponent delay={6000}></AsyncComponent> </Suspense>
		])}>Replay</button>
		</div>)
}`)},{title:"TODO App",description:`Features:
		Double click to edit.
		Drag and drop of items with mouse.
		Enter to add a new item.
		Delete items.
		Filter by done.
		Mark as done.`,code:new g(`import { DataSource, ArrayDataSource, Switch, SwitchCase, DefaultSwitchCase, dsMap } from 'aurumjs'

return function Todo() {
	const todoSource = new ArrayDataSource();
	const filteredView = todoSource.filter(() => true);
	const editing = new DataSource();
	let id = 0;
	let draggedNode;

	return (
		<div>
			<input onKeyDown={(e) => {
					if (e.keyCode === 13 && e.target.value) {
						todoSource.push({id: (id++).toString(), done: new DataSource(false), text: new DataSource(e.target.value)});
						e.target.value = '';
					}
				}}
				placeholder="What needs to be done?">
			</input>
			<ul>
				{filteredView.map((model) => {
						let item;
						return (
							<li
								onAttach={(i) => {
									item = i;
									item.model = model;
								}}
								draggable="true"
								onDragStart={() => (draggedNode = item)}
								onDragEnter={(e) => {
									if (draggedNode.parentElement === item.parentElement) {
										todoSource.swapItems(item.model, draggedNode.model);
									}
								}}
								style={model.done.transform(dsMap((done) => (done ? 'color: red;text-decoration: line-through;display: flex;justify-content: space-between;' : 'display: flex;justify-content: space-between;')))}
							>
								<Switch state={editing}>
									<SwitchCase
										when={model.id}>
										<input
										onBlur={() => editing.update(undefined)}
										onAttach={(input) => input.focus()}
										initialValue={model.text.value}
										onKeyDown={(e) => {
											if (e.keyCode === 13) {
												model.text.update(e.target.value);
												editing.update(undefined);
											} else if (e.keyCode === 27) {
												editing.update(undefined);
											}
										}}
										/>
									</SwitchCase>
									<DefaultSwitchCase>
										<div onDblClick={(e) => editing.update(model.id)}>{model.text}</div>
									</DefaultSwitchCase>
								</Switch>
								<span>
									<button onClick={() => model.done.update(!model.done.value)}>
										{model.done.transform(dsMap((done) => (done ? 'Mark as not done' : 'Mark as done')))}
									</button>
									<button onClick={() => {
											if (editing.value === model.id) {
												editing.update(undefined);
											}
											todoSource.remove(model);
										}}>X</button>
								</span>
							</li>
						);
					})}
			</ul>
			<button onClick={() => filteredView.updateFilter(() => true)}>All</button>
			<button onClick={() => filteredView.updateFilter((todo) => todo.done.value)}>Done only</button>
			<button onClick={() => filteredView.updateFilter((todo) => !todo.done.value)}>Not done only</button>
		</div>
	);
}`)}];function Ei(i){const{dataSource:e,cancellationToken:t}=i;return u.factory("div",null,e.transform(ne(),ke(1e3),re(s=>u.factory("div",null,n(s))),t));async function n(s){try{const a=await nt(()=>import("./aurumjs-288ace17.js"),[]),o=await nt(()=>import("./aurum-canvas-a90b2760.js"),[]),l=Babel.transform(`(() => {/** @jsx aurum.Aurum.factory */	
`+Si(s)+"})()",{presets:["es2015","react"]}).code;return new Function("aurum","aurumCanvas","return "+l.substring(l.indexOf("(")))(a,o)()}catch(a){return u.factory("pre",null,((a==null?void 0:a.stack)??a).toString())}}}function Si(i){return i.replace(/import\s*{(.*?)}\s*from\s'aurumjs'/g,(e,...t)=>`const {${t[0]}} = aurum;`).replace(/import\s*{(.*?)}\s*from\s'aurum-canvas'/g,(e,...t)=>`const {${t[0]}} = aurumCanvas;`)}function $e(i){const e=new T;return u.factory("div",{class:"section"},u.factory("div",{class:"row"},u.factory("ul",null,i.examples.map(t=>u.factory("li",{class:"row"},u.factory("div",{class:"col s12 m3"},u.factory("h5",null,t.title),u.factory("div",null,t.description)),u.factory("div",{class:"col s8 m6"},u.factory("div",{style:"height:300px;border:1px solid #ccc",onAttach:n=>{r(["vs/editor/editor.main"],async function(){const s=await(await fetch("data/aurum.d.ts")).text(),a=await(await fetch("data/aurum-canvas.d.ts")).text();monaco.languages.typescript.javascriptDefaults.addExtraLib([s].join(`
`),"aurum.d.ts"),monaco.languages.typescript.javascriptDefaults.addExtraLib([a].join(`
`),"aurum-canvas.d.ts");const o=monaco.editor.create(n,{value:t.code.value,minimap:{enabled:!1},theme:"vs-dark",language:"javascript"});o.onKeyUp(()=>t.code.update(o.getValue()))})}})),u.factory("div",{onDetach:()=>e.cancel(),class:"col s4 m3"},u.factory("div",null,"Result"),u.factory(Ei,{dataSource:t.code,cancellationToken:e})))))))}const kt="/aurum-website/assets/aurum-4d16654c.png";function xi(){return u.factory("div",{class:"section no-pad-bot",id:"index-banner"},u.factory("div",{class:"container"},u.factory("br",null),u.factory("div",{class:"title"},u.factory("a",{id:"logo-container",href:"#",class:"brand-logo"},u.factory("img",{src:kt})),u.factory("h1",{class:"header center orange-text"},"Aurum.js")),u.factory("div",{class:"row center"},u.factory("h5",{class:"header col s12 light"},"Fast and concise declarative DOM rendering library for javascript")),u.factory("div",{class:"row center"},u.factory("a",{href:"#/getting_started",id:"download-button",class:"btn-large waves-effect waves-light grey darken-4"},"Get Started")),u.factory("br",null)))}function Di(){return u.factory("nav",{class:"grey darken-4",role:"navigation"},u.factory("div",{class:"nav-wrapper container"},u.factory("ul",{class:"right hide-on-med-and-down"},u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#"},"Home"))),u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#/getting_started"},"Getting started"))),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://github.com/CyberPhoenix90/aurum"},"Github")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://www.npmjs.com/package/aurumjs"},"Npm"))),u.factory("ul",{class:"left hide-on-med-and-down"},u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#/aurum_canvas"},"Go to Aurum Canvas")))),u.factory("ul",{id:"nav-mobile",class:"sidenav"},u.factory("li",null,u.factory("a",{href:"#"},"Home")),u.factory("li",null,u.factory("a",{href:"#/getting_started"},"Getting started")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://github.com/CyberPhoenix90/aurum"},"Github")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://www.npmjs.com/package/aurumjs"},"Npm"))),u.factory("a",{href:"#","data-target":"nav-mobile",class:"sidenav-trigger"},u.factory("i",{class:"material-icons"},"menu"))))}function Ti(i){i.selectedNode=i.selectedNode??new g;const e=new g(i.initialFilter??""),t=new D(i.content.map(n=>({name:n.name,sections:new mt(n.sections)}))).filter(()=>!0);return e.listen(n=>{t.updateFilter(s=>!!s.sections.updateFilter(a=>a.name.toLowerCase().includes(n.toLowerCase())))}),u.factory("header",{class:"content-list"},u.factory("div",{class:"sidenav sidenav-fixed content-list",style:"width:350px"},u.factory("input",{maxLength:"20",placeholder:"Search...",value:e}),u.factory(pi,{state:t.length.transform(ke(0))},u.factory(bt,{when:0},u.factory("div",null,"No results for ",e)),u.factory(_e,null,u.factory("ul",null,t.map(n=>u.factory("li",null,i.flat?u.factory(Ci,{category:n,baseUrl:i.baseUrl,selectedNode:i.selectedNode}):u.factory(Ri,{category:n,baseUrl:i.baseUrl,selectedNode:i.selectedNode}))))))))}function Ci(i,e,t){const{category:n,selectedNode:s,baseUrl:a=""}=i;return u.factory("div",null,u.factory("ul",{style:"list-style:none"},n.sections.map(o=>u.factory("li",null,u.factory("a",{onClick:()=>s.update(o.id),class:s.transform(re(l=>l===o.id?"selected":""),t.cancellationToken),href:a+o.href},o.prefix,o.name)),[],t.cancellationToken)))}function Ri(i,e,t){const{category:n,selectedNode:s,baseUrl:a=""}=i;return u.factory("div",null,u.factory("h6",{style:"margin-left:30px; font-weight:bold;"},n.name),u.factory("ol",{style:"list-style:none"},n.sections.map(o=>u.factory("li",null,u.factory("a",{onClick:()=>s.update(o.id),class:s.transform(re(l=>l===o.id?"selected":""),t.cancellationToken),href:a+o.href},o.prefix,o.name)),[],t.cancellationToken)))}function _i(){return u.factory("div",null,u.factory("h2",null,"Examples"),u.factory("br",null),u.factory($e,{examples:At}))}function vt(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let de=vt();function Oi(i){de=i}const Ii=/[&<>"']/,Li=/[&<>"']/g,Ni=/[<>"']|&(?!#?\w+;)/,Mi=/[<>"']|&(?!#?\w+;)/g,Ui={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},st=i=>Ui[i];function $(i,e){if(e){if(Ii.test(i))return i.replace(Li,st)}else if(Ni.test(i))return i.replace(Mi,st);return i}const Pi=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function Et(i){return i.replace(Pi,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const $i=/(^|[^\[])\^/g;function _(i,e){i=typeof i=="string"?i:i.source,e=e||"";const t={replace:(n,s)=>(s=s.source||s,s=s.replace($i,"$1"),i=i.replace(n,s),t),getRegex:()=>new RegExp(i,e)};return t}const Fi=/[^\w:]/g,zi=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function it(i,e,t){if(i){let n;try{n=decodeURIComponent(Et(t)).replace(Fi,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}e&&!zi.test(t)&&(t=Hi(e,t));try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const xe={},ji=/^[^:]+:\/*[^/]*$/,Bi=/^([^:]+:)[\s\S]*$/,Ki=/^([^:]+:\/*[^/]*)[\s\S]*$/;function Hi(i,e){xe[" "+i]||(ji.test(i)?xe[" "+i]=i+"/":xe[" "+i]=Te(i,"/",!0)),i=xe[" "+i];const t=i.indexOf(":")===-1;return e.substring(0,2)==="//"?t?e:i.replace(Bi,"$1")+e:e.charAt(0)==="/"?t?e:i.replace(Ki,"$1")+e:i+e}const Oe={exec:function(){}};function H(i){let e=1,t,n;for(;e<arguments.length;e++){t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i}function rt(i,e){const t=i.replace(/\|/g,(a,o,l)=>{let c=!1,h=o;for(;--h>=0&&l[h]==="\\";)c=!c;return c?"|":" |"}),n=t.split(/ \|/);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(/\\\|/g,"|");return n}function Te(i,e,t){const n=i.length;if(n===0)return"";let s=0;for(;s<n;){const a=i.charAt(n-s-1);if(a===e&&!t)s++;else if(a!==e&&t)s++;else break}return i.slice(0,n-s)}function Wi(i,e){if(i.indexOf(e[1])===-1)return-1;const t=i.length;let n=0,s=0;for(;s<t;s++)if(i[s]==="\\")s++;else if(i[s]===e[0])n++;else if(i[s]===e[1]&&(n--,n<0))return s;return-1}function St(i){i&&i.sanitize&&!i.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function at(i,e){if(e<1)return"";let t="";for(;e>1;)e&1&&(t+=i),e>>=1,i+=i;return t+i}function ot(i,e,t,n){const s=e.href,a=e.title?$(e.title):null,o=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){n.state.inLink=!0;const l={type:"link",raw:t,href:s,title:a,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,l}return{type:"image",raw:t,href:s,title:a,text:$(o)}}function qi(i,e){const t=i.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(s=>{const a=s.match(/^\s+/);if(a===null)return s;const[o]=a;return o.length>=n.length?s.slice(n.length):s}).join(`
`)}class He{constructor(e){this.options=e||de}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Te(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],s=qi(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline._escapes,"$1"):t[2],text:s}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const s=Te(n,"#");(this.options.pedantic||!s||/ $/.test(s))&&(n=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=t[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(n,[]),text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,s,a,o,l,c,h,d,f,p,m,v,b=t[1].trim();const A=b.length>1,R={type:"list",raw:"",ordered:A,start:A?+b.slice(0,-1):"",loose:!1,items:[]};b=A?`\\d{1,9}\\${b.slice(-1)}`:`\\${b}`,this.options.pedantic&&(b=A?b:"[*+-]");const U=new RegExp(`^( {0,3}${b})((?:[	 ][^\\n]*)?(?:\\n|$))`);for(;e&&(v=!1,!(!(t=U.exec(e))||this.rules.block.hr.test(e)));){if(n=t[0],e=e.substring(n.length),d=t[2].split(`
`,1)[0],f=e.split(`
`,1)[0],this.options.pedantic?(o=2,m=d.trimLeft()):(o=t[2].search(/[^ ]/),o=o>4?1:o,m=d.slice(o),o+=t[1].length),c=!1,!d&&/^ *$/.test(f)&&(n+=f+`
`,e=e.substring(f.length+1),v=!0),!v){const ae=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))`),V=new RegExp(`^ {0,${Math.min(3,o-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),J=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:\`\`\`|~~~)`),le=new RegExp(`^ {0,${Math.min(3,o-1)}}#`);for(;e&&(p=e.split(`
`,1)[0],d=p,this.options.pedantic&&(d=d.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(J.test(d)||le.test(d)||ae.test(d)||V.test(e)));){if(d.search(/[^ ]/)>=o||!d.trim())m+=`
`+d.slice(o);else if(!c)m+=`
`+d;else break;!c&&!d.trim()&&(c=!0),n+=p+`
`,e=e.substring(p.length+1)}}R.loose||(h?R.loose=!0:/\n *\n *$/.test(n)&&(h=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(m),s&&(a=s[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),R.items.push({type:"list_item",raw:n,task:!!s,checked:a,loose:!1,text:m}),R.raw+=n}R.items[R.items.length-1].raw=n.trimRight(),R.items[R.items.length-1].text=m.trimRight(),R.raw=R.raw.trimRight();const he=R.items.length;for(l=0;l<he;l++){this.lexer.state.top=!1,R.items[l].tokens=this.lexer.blockTokens(R.items[l].text,[]);const ae=R.items[l].tokens.filter(J=>J.type==="space"),V=ae.every(J=>{const le=J.raw.split("");let fe=0;for(const Tt of le)if(Tt===`
`&&(fe+=1),fe>1)return!0;return!1});!R.loose&&ae.length&&V&&(R.loose=!0,R.items[l].loose=!0)}return R}}html(e){const t=this.rules.block.html.exec(e);if(t){const n={type:"html",raw:t[0],pre:!this.options.sanitizer&&(t[1]==="pre"||t[1]==="script"||t[1]==="style"),text:t[0]};if(this.options.sanitize){const s=this.options.sanitizer?this.options.sanitizer(t[0]):$(t[0]);n.type="paragraph",n.text=s,n.tokens=this.lexer.inline(s)}return n}}def(e){const t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2]?t[2].replace(this.rules.inline._escapes,"$1"):t[2],title:t[3]?t[3].replace(this.rules.inline._escapes,"$1"):t[3]}}table(e){const t=this.rules.block.table.exec(e);if(t){const n={type:"table",header:rt(t[1]).map(s=>({text:s})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];let s=n.align.length,a,o,l,c;for(a=0;a<s;a++)/^ *-+: *$/.test(n.align[a])?n.align[a]="right":/^ *:-+: *$/.test(n.align[a])?n.align[a]="center":/^ *:-+ *$/.test(n.align[a])?n.align[a]="left":n.align[a]=null;for(s=n.rows.length,a=0;a<s;a++)n.rows[a]=rt(n.rows[a],n.header.length).map(h=>({text:h}));for(s=n.header.length,o=0;o<s;o++)n.header[o].tokens=this.lexer.inline(n.header[o].text);for(s=n.rows.length,o=0;o<s;o++)for(c=n.rows[o],l=0;l<c.length;l++)c[l].tokens=this.lexer.inline(c[l].text);return n}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:$(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):$(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const o=Te(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=Wi(t[2],"()");if(o>-1){const c=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,c).trim(),t[3]=""}}let s=t[2],a="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);o&&(s=o[1],a=o[3])}else a=t[3]?t[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(n)?s=s.slice(1):s=s.slice(1,-1)),ot(t,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:a&&a.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let s=(n[2]||n[1]).replace(/\s+/g," ");if(s=t[s.toLowerCase()],!s||!s.href){const a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return ot(n,s,n[0],this.lexer)}}emStrong(e,t,n=""){let s=this.rules.inline.emStrong.lDelim.exec(e);if(!s||s[3]&&n.match(/[\p{L}\p{N}]/u))return;const a=s[1]||s[2]||"";if(!a||a&&(n===""||this.rules.inline.punctuation.exec(n))){const o=s[0].length-1;let l,c,h=o,d=0;const f=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(f.lastIndex=0,t=t.slice(-1*e.length+o);(s=f.exec(t))!=null;){if(l=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!l)continue;if(c=l.length,s[3]||s[4]){h+=c;continue}else if((s[5]||s[6])&&o%3&&!((o+c)%3)){d+=c;continue}if(h-=c,h>0)continue;c=Math.min(c,c+h+d);const p=e.slice(0,o+s.index+(s[0].length-l.length)+c);if(Math.min(o,c)%2){const v=p.slice(1,-1);return{type:"em",raw:p,text:v,tokens:this.lexer.inlineTokens(v)}}const m=p.slice(2,-2);return{type:"strong",raw:p,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const s=/[^ ]/.test(n),a=/^ /.test(n)&&/ $/.test(n);return s&&a&&(n=n.substring(1,n.length-1)),n=$(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let s,a;return n[2]==="@"?(s=$(this.options.mangle?t(n[1]):n[1]),a="mailto:"+s):(s=$(n[1]),a=s),{type:"link",raw:n[0],text:s,href:a,tokens:[{type:"text",raw:s,text:s}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let s,a;if(n[2]==="@")s=$(this.options.mangle?t(n[0]):n[0]),a="mailto:"+s;else{let o;do o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(o!==n[0]);s=$(n[0]),n[1]==="www."?a="http://"+s:a=s}return{type:"link",raw:n[0],text:s,href:a,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):$(n[0]):n[0]:s=$(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:s}}}}const S={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Oe,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};S._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;S._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;S.def=_(S.def).replace("label",S._label).replace("title",S._title).getRegex();S.bullet=/(?:[*+-]|\d{1,9}[.)])/;S.listItemStart=_(/^( *)(bull) */).replace("bull",S.bullet).getRegex();S.list=_(S.list).replace(/bull/g,S.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+S.def.source+")").getRegex();S._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";S._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;S.html=_(S.html,"i").replace("comment",S._comment).replace("tag",S._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();S.paragraph=_(S._paragraph).replace("hr",S.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S._tag).getRegex();S.blockquote=_(S.blockquote).replace("paragraph",S.paragraph).getRegex();S.normal=H({},S);S.gfm=H({},S.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});S.gfm.table=_(S.gfm.table).replace("hr",S.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S._tag).getRegex();S.gfm.paragraph=_(S._paragraph).replace("hr",S.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",S.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",S._tag).getRegex();S.pedantic=H({},S.normal,{html:_(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",S._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Oe,paragraph:_(S.normal._paragraph).replace("hr",S.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",S.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const E={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Oe,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Oe,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};E._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";E.punctuation=_(E.punctuation).replace(/punctuation/g,E._punctuation).getRegex();E.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;E.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g;E._comment=_(S._comment).replace("(?:-->|$)","-->").getRegex();E.emStrong.lDelim=_(E.emStrong.lDelim).replace(/punct/g,E._punctuation).getRegex();E.emStrong.rDelimAst=_(E.emStrong.rDelimAst,"g").replace(/punct/g,E._punctuation).getRegex();E.emStrong.rDelimUnd=_(E.emStrong.rDelimUnd,"g").replace(/punct/g,E._punctuation).getRegex();E._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;E._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;E._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;E.autolink=_(E.autolink).replace("scheme",E._scheme).replace("email",E._email).getRegex();E._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;E.tag=_(E.tag).replace("comment",E._comment).replace("attribute",E._attribute).getRegex();E._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;E._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;E._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;E.link=_(E.link).replace("label",E._label).replace("href",E._href).replace("title",E._title).getRegex();E.reflink=_(E.reflink).replace("label",E._label).replace("ref",S._label).getRegex();E.nolink=_(E.nolink).replace("ref",S._label).getRegex();E.reflinkSearch=_(E.reflinkSearch,"g").replace("reflink",E.reflink).replace("nolink",E.nolink).getRegex();E.normal=H({},E);E.pedantic=H({},E.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:_(/^!?\[(label)\]\((.*?)\)/).replace("label",E._label).getRegex(),reflink:_(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",E._label).getRegex()});E.gfm=H({},E.normal,{escape:_(E.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});E.gfm.url=_(E.gfm.url,"i").replace("email",E.gfm._extended_email).getRegex();E.breaks=H({},E.gfm,{br:_(E.br).replace("{2,}","*").getRegex(),text:_(E.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function Yi(i){return i.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function lt(i){let e="",t,n;const s=i.length;for(t=0;t<s;t++)n=i.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),e+="&#"+n+";";return e}class Z{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||de,this.options.tokenizer=this.options.tokenizer||new He,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:S.normal,inline:E.normal};this.options.pedantic?(t.block=S.pedantic,t.inline=E.pedantic):this.options.gfm&&(t.block=S.gfm,this.options.breaks?t.inline=E.breaks:t.inline=E.gfm),this.tokenizer.rules=t}static get rules(){return{block:S,inline:E}}static lex(e,t){return new Z(t).lex(e)}static lexInline(e,t){return new Z(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);let t;for(;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(l,c,h)=>c+"    ".repeat(h.length));let n,s,a,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(n=l.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0;const c=e.slice(1);let h;this.options.extensions.startBlock.forEach(function(d){h=d.call({lexer:this},c),typeof h=="number"&&h>=0&&(l=Math.min(l,h))}),l<1/0&&l>=0&&(a=e.substring(0,l+1))}if(this.state.top&&(n=this.tokenizer.paragraph(a))){s=t[t.length-1],o&&s.type==="paragraph"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(n),o=a.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&s.type==="text"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(n);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,s,a,o=e,l,c,h;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)d.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,l.index)+"["+at("a",l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,l.index)+"["+at("a",l[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,l.index+l[0].length-2)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;for(;e;)if(c||(h=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(n=d.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),s=t[t.length-1],s&&n.type==="text"&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),s=t[t.length-1],s&&n.type==="text"&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,o,h)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e,lt)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e,lt))){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const f=e.slice(1);let p;this.options.extensions.startInline.forEach(function(m){p=m.call({lexer:this},f),typeof p=="number"&&p>=0&&(d=Math.min(d,p))}),d<1/0&&d>=0&&(a=e.substring(0,d+1))}if(n=this.tokenizer.inlineText(a,Yi)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(h=n.raw.slice(-1)),c=!0,s=t[t.length-1],s&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):t.push(n);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class We{constructor(e){this.options=e||de}code(e,t,n){const s=(t||"").match(/\S*/)[0];if(this.options.highlight){const a=this.options.highlight(e,s);a!=null&&a!==e&&(n=!0,e=a)}return e=e.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+$(s,!0)+'">'+(n?e:$(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:$(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e){return e}heading(e,t,n,s){if(this.options.headerIds){const a=this.options.headerPrefix+s.slug(n);return`<h${t} id="${a}">${e}</h${t}>
`}return`<h${t}>${e}</h${t}>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(e,t,n){const s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+e+"</"+s+`>
`}listitem(e){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){if(e=it(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let s='<a href="'+$(e)+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>",s}image(e,t,n){if(e=it(this.options.sanitize,this.options.baseUrl,e),e===null)return n;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${t}"`),s+=this.options.xhtml?"/>":">",s}text(e){return e}}class xt{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Dt{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,s=0;if(this.seen.hasOwnProperty(n)){s=this.seen[e];do s++,n=e+"-"+s;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=s,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class Y{constructor(e){this.options=e||de,this.options.renderer=this.options.renderer||new We,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new xt,this.slugger=new Dt}static parse(e,t){return new Y(t).parse(e)}static parseInline(e,t){return new Y(t).parseInline(e)}parse(e,t=!0){let n="",s,a,o,l,c,h,d,f,p,m,v,b,A,R,U,he,ae,V,J;const le=e.length;for(s=0;s<le;s++){if(m=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(J=this.options.extensions.renderers[m.type].call({parser:this},m),J!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){n+=J||"";continue}switch(m.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(m.tokens),m.depth,Et(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(m.text,m.lang,m.escaped);continue}case"table":{for(f="",d="",l=m.header.length,a=0;a<l;a++)d+=this.renderer.tablecell(this.parseInline(m.header[a].tokens),{header:!0,align:m.align[a]});for(f+=this.renderer.tablerow(d),p="",l=m.rows.length,a=0;a<l;a++){for(h=m.rows[a],d="",c=h.length,o=0;o<c;o++)d+=this.renderer.tablecell(this.parseInline(h[o].tokens),{header:!1,align:m.align[o]});p+=this.renderer.tablerow(d)}n+=this.renderer.table(f,p);continue}case"blockquote":{p=this.parse(m.tokens),n+=this.renderer.blockquote(p);continue}case"list":{for(v=m.ordered,b=m.start,A=m.loose,l=m.items.length,p="",a=0;a<l;a++)U=m.items[a],he=U.checked,ae=U.task,R="",U.task&&(V=this.renderer.checkbox(he),A?U.tokens.length>0&&U.tokens[0].type==="paragraph"?(U.tokens[0].text=V+" "+U.tokens[0].text,U.tokens[0].tokens&&U.tokens[0].tokens.length>0&&U.tokens[0].tokens[0].type==="text"&&(U.tokens[0].tokens[0].text=V+" "+U.tokens[0].tokens[0].text)):U.tokens.unshift({type:"text",text:V}):R+=V),R+=this.parse(U.tokens,A),p+=this.renderer.listitem(R,ae,he);n+=this.renderer.list(p,v,b);continue}case"html":{n+=this.renderer.html(m.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(m.tokens));continue}case"text":{for(p=m.tokens?this.parseInline(m.tokens):m.text;s+1<le&&e[s+1].type==="text";)m=e[++s],p+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);n+=t?this.renderer.paragraph(p):p;continue}default:{const fe='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(fe);return}else throw new Error(fe)}}}return n}parseInline(e,t){t=t||this.renderer;let n="",s,a,o;const l=e.length;for(s=0;s<l;s++){if(a=e[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]&&(o=this.options.extensions.renderers[a.type].call({parser:this},a),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type))){n+=o||"";continue}switch(a.type){case"escape":{n+=t.text(a.text);break}case"html":{n+=t.html(a.text);break}case"link":{n+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{n+=t.image(a.href,a.title,a.text);break}case"strong":{n+=t.strong(this.parseInline(a.tokens,t));break}case"em":{n+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{n+=t.codespan(a.text);break}case"br":{n+=t.br();break}case"del":{n+=t.del(this.parseInline(a.tokens,t));break}case"text":{n+=t.text(a.text);break}default:{const c='Token with "'+a.type+'" type was not found.';if(this.options.silent){console.error(c);return}else throw new Error(c)}}}return n}}function x(i,e,t){if(typeof i>"u"||i===null)throw new Error("marked(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");if(typeof e=="function"&&(t=e,e=null),e=H({},x.defaults,e||{}),St(e),t){const s=e.highlight;let a;try{a=Z.lex(i,e)}catch(c){return t(c)}const o=function(c){let h;if(!c)try{e.walkTokens&&x.walkTokens(a,e.walkTokens),h=Y.parse(a,e)}catch(d){c=d}return e.highlight=s,c?t(c):t(null,h)};if(!s||s.length<3||(delete e.highlight,!a.length))return o();let l=0;x.walkTokens(a,function(c){c.type==="code"&&(l++,setTimeout(()=>{s(c.text,c.lang,function(h,d){if(h)return o(h);d!=null&&d!==c.text&&(c.text=d,c.escaped=!0),l--,l===0&&o()})},0))}),l===0&&o();return}function n(s){if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+$(s.message+"",!0)+"</pre>";throw s}try{const s=Z.lex(i,e);if(e.walkTokens){if(e.async)return Promise.all(x.walkTokens(s,e.walkTokens)).then(()=>Y.parse(s,e)).catch(n);x.walkTokens(s,e.walkTokens)}return Y.parse(s,e)}catch(s){n(s)}}x.options=x.setOptions=function(i){return H(x.defaults,i),Oi(x.defaults),x};x.getDefaults=vt;x.defaults=de;x.use=function(...i){const e=H({},...i),t=x.defaults.extensions||{renderers:{},childTokens:{}};let n;i.forEach(s=>{if(s.extensions&&(n=!0,s.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if(a.renderer){const o=t.renderers?t.renderers[a.name]:null;o?t.renderers[a.name]=function(...l){let c=a.renderer.apply(this,l);return c===!1&&(c=o.apply(this,l)),c}:t.renderers[a.name]=a.renderer}if(a.tokenizer){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");t[a.level]?t[a.level].unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}a.childTokens&&(t.childTokens[a.name]=a.childTokens)})),s.renderer){const a=x.defaults.renderer||new We;for(const o in s.renderer){const l=a[o];a[o]=(...c)=>{let h=s.renderer[o].apply(a,c);return h===!1&&(h=l.apply(a,c)),h}}e.renderer=a}if(s.tokenizer){const a=x.defaults.tokenizer||new He;for(const o in s.tokenizer){const l=a[o];a[o]=(...c)=>{let h=s.tokenizer[o].apply(a,c);return h===!1&&(h=l.apply(a,c)),h}}e.tokenizer=a}if(s.walkTokens){const a=x.defaults.walkTokens;e.walkTokens=function(o){let l=[];return l.push(s.walkTokens.call(this,o)),a&&(l=l.concat(a.call(this,o))),l}}n&&(e.extensions=t),x.setOptions(e)})};x.walkTokens=function(i,e){let t=[];for(const n of i)switch(t=t.concat(e.call(x,n)),n.type){case"table":{for(const s of n.header)t=t.concat(x.walkTokens(s.tokens,e));for(const s of n.rows)for(const a of s)t=t.concat(x.walkTokens(a.tokens,e));break}case"list":{t=t.concat(x.walkTokens(n.items,e));break}default:x.defaults.extensions&&x.defaults.extensions.childTokens&&x.defaults.extensions.childTokens[n.type]?x.defaults.extensions.childTokens[n.type].forEach(function(s){t=t.concat(x.walkTokens(n[s],e))}):n.tokens&&(t=t.concat(x.walkTokens(n.tokens,e)))}return t};x.parseInline=function(i,e){if(typeof i>"u"||i===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");e=H({},x.defaults,e||{}),St(e);try{const t=Z.lexInline(i,e);return e.walkTokens&&x.walkTokens(t,e.walkTokens),Y.parseInline(t,e)}catch(t){if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,e.silent)return"<p>An error occurred:</p><pre>"+$(t.message+"",!0)+"</pre>";throw t}};x.Parser=Y;x.parser=Y.parse;x.Renderer=We;x.TextRenderer=xt;x.Lexer=Z;x.lexer=Z.lex;x.Tokenizer=He;x.Slugger=Dt;x.parse=x;x.options;x.setOptions;x.use;x.walkTokens;x.parseInline;Y.parse;Z.lex;function Vi(i,e){return u.factory("div",{onAttach:t=>{t.innerHTML=x(e[0])}})}function P(i){return u.factory("div",{class:"page"},u.factory("h2",null,i.title),u.factory("br",null),u.factory("div",null,u.factory(fi,{fallback:"Loading..."},fetch(i.url).then(e=>e.text()).then(e=>u.factory(Vi,null,e)))))}const Ji=[{name:"Aurum.js",sections:[{prefix:"1. ",href:"",name:"Quickstart",id:""},{prefix:"2. ",href:"coreideas",name:"Core ideas",id:"coreideas"},{prefix:"3. ",href:"why",name:"Why Aurum",id:"why"},{prefix:"4. ",href:"examples",name:"Examples",id:"examples"}]},{name:"JSX",sections:[{prefix:"1. ",href:"syntax",name:"Syntax",id:"syntax"},{prefix:"2. ",href:"typescript",name:"Typescript",id:"typescript"},{prefix:"3. ",href:"vite",name:"Vite",id:"vite"},{prefix:"4. ",href:"babel",name:"Babel",id:"babel"}]},{name:"State management",sections:[{prefix:"1. ",href:"datasource",name:"DataSource",id:"datasource"},{prefix:"2. ",href:"arraydatasource",name:"ArrayDataSource",id:"arraydatasource"},{prefix:"3. ",href:"objectdatasource",name:"ObjectDataSource",id:"objectdatasource"}]},{name:"Components",sections:[{prefix:"1. ",href:"functional",name:"Functional",id:"functional"},{prefix:"2. ",href:"classes",name:"Class based",id:"classes"},{prefix:"3. ",href:"async",name:"Async components",id:"async"},{prefix:"4. ",href:"transclude",name:"Transclusion",id:"transclude"}]},{name:"Builtins",sections:[{prefix:"1. ",href:"switches",name:"Switch component",id:"switches"},{prefix:"2. ",href:"router",name:"AurumRouter component",id:"router"},{prefix:"3. ",href:"suspense",name:"Suspense component",id:"suspense"},{prefix:"4. ",href:"error_boundary",name:"ErrorBoundary component",id:"errorboundary"}]}];function Gi(){const i=new g(ct());return window.addEventListener("hashchange",()=>{i.update(ct())}),u.factory("div",{class:"documentation-page"},u.factory(Ti,{selectedNode:i,baseUrl:"#/getting_started/",content:Ji}),u.factory("div",{class:"documentation-content"},u.factory(De,null,u.factory(L,{href:"/getting_started/coreideas"},u.factory(P,{title:"Core ideas",url:"documentation/core_ideas.md"})),u.factory(L,{href:"/getting_started/why"},u.factory(P,{title:"Why Aurum",url:"documentation/why.md"})),u.factory(L,{href:"/getting_started/syntax"},u.factory(P,{title:"Syntax",url:"documentation/syntax.md"})),u.factory(L,{href:"/getting_started/classes"},u.factory(P,{title:"Class based components",url:"documentation/classes.md"})),u.factory(L,{href:"/getting_started/functional"},u.factory(P,{title:"Function based components",url:"documentation/functional.md"})),u.factory(L,{href:"/getting_started/typescript"},u.factory(P,{title:"Using Aurum with typescript",url:"documentation/typescript.md"})),u.factory(L,{href:"/getting_started/vite"},u.factory(P,{title:"Using Aurum with vite",url:"documentation/vite.md"})),u.factory(L,{href:"/getting_started/babel"},u.factory(P,{title:"Using Aurum with babel",url:"documentation/babel.md"})),u.factory(L,{href:"/getting_started/switches"},u.factory(P,{title:"Builtin components: Switch",url:"documentation/switches.md"})),u.factory(L,{href:"/getting_started/router"},u.factory(P,{title:"Builtin components: Router",url:"documentation/router.md"})),u.factory(L,{href:"/getting_started/suspense"},u.factory(P,{title:"Builtin components: Suspense",url:"documentation/suspense.md"})),u.factory(L,{href:"/getting_started/error_boundary"},u.factory(P,{title:"Builtin components: ErrorBoundary",url:"documentation/error_boundary.md"})),u.factory(L,{href:"/getting_started/examples"},u.factory(_i,null)),u.factory(L,{href:"/getting_started/async"},u.factory(P,{title:"Async components",url:"documentation/async.md"})),u.factory(L,{href:"/getting_started/transclude"},u.factory(P,{title:"Transclusion",url:"documentation/transclusion.md"})),u.factory(L,{href:"/getting_started/datasource"},u.factory(P,{title:"DataSource",url:"documentation/datasource.md"})),u.factory(L,{href:"/getting_started/arraydatasource"},u.factory(P,{title:"ArrayDataSource",url:"documentation/arraydatasource.md"})),u.factory(L,{href:"/getting_started/objectdatasource"},u.factory(P,{title:"ObjectDataSource",url:"documentation/objectdatasource.md"})),u.factory(te,null,u.factory(P,{title:"Quickstart",url:"documentation/quickstart.md"})))))}function ct(){const i=location.hash.substring(1);return i.startsWith("/getting_started/")?i.substring(17):""}function Zi(){return u.factory("div",{class:"container"},u.factory("div",{class:"section"},u.factory("div",{class:"row"},u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"bar_chart")),u.factory("h5",{class:"center"},"Canvas made easy"),u.factory("p",{class:"light"},"Aurum Canvas demystifies the canvas and gives it a simple DOM like API with high level features such as hit detection, zooming and panning all with Aurum.js simple concepts. This allows you to write and animate charts declaratively."))),u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"query_builder")),u.factory("h5",{class:"center"},"Small learning curve"),u.factory("p",{class:"light"},"If you know Aurum.js you can get going in minutes. If not aurum itself has a small learning curve as well"))),u.factory("div",{class:"col s12 m4"},u.factory("div",{class:"icon-block"},u.factory("h2",{class:"center orange-text"},u.factory("i",{class:"material-icons"},"settings")),u.factory("h5",{class:"center"},"Integrates seamlessly with aurum"),u.factory("p",{class:"light"},"Aurum canvas is an aurum plugin that uses all the same concepts. You can transition form dom to canvas seamlessly and even reuse components between canvas and dom!"))))),u.factory("br",null))}const Xi=[{title:"Hello world",description:"Basic Hello world example",code:new g(`import {AurumCanvas, AurumText} from 'aurum-canvas'

return function() {
	return <div>Hello from aurum.js
		<AurumCanvas width="300px" height="200px" backgroundColor="black">
			<AurumText fontSize={16} x={10} y={50} fillColor="white">Hello Aurum canvas</AurumText>
		</AurumCanvas>
	</div>
}`)},{title:"Basic animations",description:"Use datasources for animations",code:new g(`import {AurumCanvas, AurumText} from 'aurum-canvas'
import {tweenEmitter, DataSource, dsMap} from 'aurumjs'

return function() {
	const y = new DataSource(20);
	const colorAngle = new DataSource(0)
	y.listen(() => colorAngle.update(colorAngle.value+2))
	goDown(y);

	return <div>Position Y: {y.transform(dsMap(v => Math.floor(v)))}
		<AurumCanvas width="300px" height="200px" backgroundColor="black">
			<AurumText fontSize={16} x={15} y={y} fillColor={colorAngle.transform(dsMap(angle => \`hsl(\${angle},100%,50%)\`))}>Hello Aurum canvas</AurumText>
		</AurumCanvas>
	</div>
}

function goDown(x) {
	tweenEmitter(x, 1500, 20, 200, i => i**2).then(() => goUp(x))
}

function goUp(x) {
	tweenEmitter(x, 3000, 200, 20, i => Math.sin(i*Math.PI/2)).then(() => goDown(x))
}`)},{title:"Interaction",description:"Hover on shapes, click and drag to move ",code:new g(`import {AurumCanvas, AurumText, AurumRectangle, AurumRegularPolygon, AurumPath, AurumElipse} from 'aurum-canvas'
import {DataSource} from 'aurumjs'

return function() {
	const translation = new DataSource({x:0,y:0})
	const hover=new DataSource('Nothing');

	return <div>
	<button onClick={() =>translation.update({x:0,y:0})}>Reset Viewport</button>
			Hovering on: {hover}
			<AurumCanvas
			translate={translation}
			onAttach={canvas => canvas.addEventListener('wheel', (e) => e.preventDefault())} features={{
			panning: {
				mouse: true
			}
		}} width="300px" height="300px" backgroundColor="black">
			<AurumText onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Text')} fontSize={16} x={45} y={50} fillColor="white">Explore!</AurumText>
			<AurumText onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Text')} fontSize={16} x={75} y={165} fillColor="white">Click and drag to move camera</AurumText>
			<AurumRectangle onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Rectangle')}  x={150} y={170} width={30} height={45} fillColor="red"></AurumRectangle>
			<AurumPath onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Path')} path="M150 0 L75 200 L225 200 Z" x={50} y={170} fillColor="blue"></AurumPath>
			<AurumRegularPolygon onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Heptagon')}  sides={7} radius={70} fillColor="green" x={-50} y={50}></AurumRegularPolygon>
			<AurumElipse onMouseLeave={() => hover.update('Nothing')} onMouseEnter={() => hover.update('Elipse')}  rx={30} ry={60} fillColor="yellow" x={200} y={50}></AurumElipse>
		</AurumCanvas>
	</div>
}
`)}];function Qi(){return u.factory("div",{class:"section no-pad-bot",id:"index-banner"},u.factory("div",{class:"container"},u.factory("br",null),u.factory("div",{class:"title"},u.factory("a",{id:"logo-container",href:"#",class:"brand-logo"},u.factory("img",{src:kt})),u.factory("h1",{class:"header center orange-text"},"Aurum Canvas")),u.factory("div",{class:"row center"},u.factory("h5",{class:"header col s12 light"},"Canvas made easy with aurum")),u.factory("div",{class:"row center"},u.factory("a",{href:"#/aurum_canvas/getting_started",id:"download-button",class:"btn-large waves-effect waves-light grey darken-4"},"Get Started")),u.factory("br",null)))}function er(){return u.factory("nav",{class:"grey darken-4",role:"navigation"},u.factory("div",{class:"nav-wrapper container"},u.factory("ul",{class:"right hide-on-med-and-down"},u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#"},"Home"))),u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#/getting_started"},"Getting started"))),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://github.com/CyberPhoenix90/aurum"},"Github")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://www.npmjs.com/package/aurumjs"},"Npm"))),u.factory("ul",{class:"left hide-on-med-and-down"},u.factory("li",null,u.factory("div",{class:"title"},u.factory("a",{href:"#"},"Go to Aurum")))),u.factory("ul",{id:"nav-mobile",class:"sidenav"},u.factory("li",null,u.factory("a",{href:"#"},"Home")),u.factory("li",null,u.factory("a",{href:"#/getting_started"},"Getting started")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://github.com/CyberPhoenix90/aurum"},"Github")),u.factory("li",null,u.factory("a",{target:"_blank",href:"https://www.npmjs.com/package/aurumjs"},"Npm"))),u.factory("a",{href:"#","data-target":"nav-mobile",class:"sidenav-trigger"},u.factory("i",{class:"material-icons"},"menu"))))}r.config({paths:{vs:"node_modules/monaco-editor/min/vs"}});u.attach(u.factory("div",{onAttach:()=>setTimeout(()=>M.AutoInit())},u.factory(De,null,u.factory(L,{href:"/aurum_canvas"},u.factory(er,null)),u.factory(te,null,u.factory(Di,null))),u.factory(De,null,u.factory(L,{href:"/aurum_canvas"},u.factory(De,null,u.factory(L,{href:"/aurum_canvas/getting_started"}),u.factory(te,null,u.factory(Qi,null),u.factory(Zi,null),u.factory("div",{class:"container"},u.factory($e,{examples:Xi}))))),u.factory(L,{href:"/getting_started"},u.factory(Gi,null)),u.factory(te,null,u.factory("div",null,u.factory(xi,null),u.factory(Ai,null),u.factory("div",{class:"container"},u.factory($e,{examples:At})))))),document.body);export{dr as $,u as A,Yt as B,T as C,g as D,I as E,Bt as F,mt as G,Ie as H,z as I,B as J,Br as K,Vt as L,Kt as M,Kr as N,Ve as O,X as P,re as Q,O as R,Ge as S,rr as T,qt as U,ar as V,pt as W,or as X,lr as Y,cr as Z,ur as _,ye as a,hr as a0,fr as a1,pr as a2,mr as a3,yr as a4,gr as a5,wr as a6,ne as a7,br as a8,Ar as a9,jr as aA,k as aB,F as aC,Vr as aD,li as aE,Jr as aF,ci as aG,Gr as aH,ut as aI,Jt as aJ,Hr as aK,Wr as aL,qr as aM,ve as aN,oe as aO,ui as aP,Ke as aQ,gi as aR,wi as aS,bi as aT,yi as aU,ir as aV,ze as aW,kr as aa,vr as ab,Er as ac,Sr as ad,ke as ae,xr as af,Dr as ag,Tr as ah,Cr as ai,Rr as aj,_r as ak,Or as al,Ir as am,Lr as an,Nr as ao,je as ap,Mr as aq,Ur as ar,Pr as as,$r as at,j as au,W as av,Fr as aw,zr as ax,jt as ay,Ye as az,y as b,Ee as c,C as d,D as e,yt as f,me as g,Xt as h,gt as i,Qt as j,q as k,Be as l,Yr as m,ce as n,sr as o,nr as p,De as q,L as r,te as s,fi as t,hi as u,pi as v,bt as w,_e as x,Ht as y,Wt as z};
